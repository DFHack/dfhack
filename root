{"version":1,"ops":[{"type":1,"author":{"id":"6cba4e25b9bf1fe499f4413bdb576893a2eb663c"},"timestamp":1465495305,"metadata":{"github-id":"MDU6SXNzdWUxNTk0NzA5MDM=","github-url":"https://github.com/DFHack/dfhack/issues/942","origin":"github"},"title":"df.global.ui_advmode Structures identification/research","message":"**df.global.ui_advmode.anon_9**\nThis is initially equal to df.global.cur_year_tick_advmode and they both increase at the same rate. However, it does not seem to update when sleeping and fast-travelling, resulting in a value which differs from df.global.cur_year_tick_advmode\n\n**df.global.ui_advmode.anon_50**\nHours of sleep. This value is updated whenever the player changes the number of hours to be slept when viewing the sleep menu.\n\n**df.global.ui_advmode.anon_56**\nIs usually set to **0**\nIs set to **2** when the adventurer unit is unconscious/falling\nSetting it to **0** when the adventurer is unconscious allows the player to move the adventurer, but it is immediately set to **2** again if the unit is still unconscious\nHence, it seems that this is what prevents a player from controlling the adventurer when such a status effect is in play.\n\n**df.global.ui_advmode.anon_59 \ndf.global.ui_advmode.anon_60\ndf.global.ui_advmode.anon_61**\nanon_59 is an x coordinate, anon_60 is y, anon_61 is z\nThese coordinates appear to be set when the adventurer becomes a projectile via jumping/falling; they are the coordinates where the flight trajectory ends (not necessarily the chosen target coordinates when jumping).\n\n**df.global.ui_advmode.anon_15\ndf.global.ui_advmode.anon_16\ndf.global.ui_advmode.anon_17**\nanon_15 appears to contain a list of x coordinates\nanon_16 appears to contain a list of y coordinates\nanon_17 appears to contain a list of z coordinates\n(values in each list are initially set to -1000000)\nEach entry is likely combined with its equivalents in the other anons, but the overall function remains unknown.\n\n**df.global.ui_advmode.anon2\ndf.global.ui_advmode.anon3**\nand\n**df.global.ui_advmode.unk23\ndf.global.ui_advmode.unk24**\nThe above two pairs appear to be linked with the adventurer’s position on the map, though I’m not yet sure about the specifics. The values appear to be updated only when the map is reloaded, or when the adventurer enters travel mode.\n\n**df.global.ui_advmode.menu = 30** \nThe “select target” screen for interactions\n\nThe following are set when the adventurer loads the interaction target selection screen:\n\n**df.global.ui_advmode.unk_1e8** \nUsed when the interaction is a “natural ability” (otherwise, it is set to -1)\nRelates to the interaction's index in the adventurer's unit.curse.own_interaction\n\n**df.global.ui_advmode.unk_1ec**\nUsed for acquired interactions (otherwise set to -1)\nThis relates to the interaction as shown below: df.interaction.find(df.global.world.raws.effects.interactions[df.global.ui_advmode.unk_1ec])\n\n**df.global.ui_advmode.unk_f4**\nThe maximum number of targets for the interaction \n\n**df.global.ui_advmode.unk_f8**\nThe maximum range of the interaction\n\n**df.global.ui_advmode.unk_fc**\nPossibly relates to the interaction target type?\nFor example, changing it to “4” made “disturber only” show up on the target selection screen.\n“2” = adjacent only , “6” = adjacent only, disturber only\nHowever, higher values seem to be repetitions, so I am uncertain about this.\n\n**df.global.ui_advmode.unk_1e4\ndf.global.ui_advmode.unk_f0\ndf.global.ui_advmode.unk_200**\nUnknown function, but changing their value crashes the game upon attempting to view the interaction screen. \nunk_f0 and unk_200 appear to be reset to 0 once the interaction is carried out\n\n**df.global.ui_advmode.unk37\ndf.global.ui_advmode.unk38**\nContain userdata which seems to be created upon when the interaction target selection screen is loaded. Deleting the userdata in unk38 causes any available target choices to disappear. Moving the cursor causes it to reappear, with userdata being generated again. Userdata in unk37 does not seem to regenerate.","files":null}]}