{"version":1,"ops":[{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1468378436,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDIzMjI0MDUxMA==","github-url":"https://github.com/DFHack/dfhack/issues/961#issuecomment-232240510"},"message":"It could be a version mismatch - what external version of Agui are you using?","files":null},{"type":3,"author":{"id":"3777bd9464a985e5d5f5348b51d9318b5e1c4118"},"timestamp":1468379690,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDIzMjI0NDM5OA==","github-url":"https://github.com/DFHack/dfhack/issues/961#issuecomment-232244398"},"message":"I tried the latest (and only one tagged on github, anyway) stable release, [0.2.1](https://github.com/jmasterx/Agui/releases), and also the latest commit. I'm not sure if versions are tracked anywhere else; presumably there _were_ previous releases but I'm not sure where to find them.","files":null},{"type":3,"author":{"id":"3777bd9464a985e5d5f5348b51d9318b5e1c4118"},"timestamp":1468381122,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDIzMjI0ODQyMg==","github-url":"https://github.com/DFHack/dfhack/issues/961#issuecomment-232248422"},"message":"Hm, I tested with [this commit](https://github.com/jmasterx/Agui/tree/6b1d4da5d562bebff47292e38a0b03320901936d), which is from March 2013. Agui was added to the isoworld tree in April 2013, it appears, so... this is probably the right version, I would think. It still doesn't work though.\n\n[This (zipped) patch](https://github.com/DFHack/dfhack/files/360632/isoworld-patch.zip) is what I've done so far, source below, if anyone wants to try and reproduce this.\n\n```\ndiff -rupN dfhack/plugins/isoworld/CMakeLists.txt dfhack-fork/plugins/isoworld/CMakeLists.txt\n--- dfhack/plugins/isoworld/CMakeLists.txt      2016-07-07 16:43:07.000000000 -0400\n+++ dfhack-fork/plugins/isoworld/CMakeLists.txt 2016-07-12 22:04:41.787097086 -0400\n@@ -56,8 +56,8 @@ IF(UNIX)\n                ENDIF()\n        ELSE(APPLE)\n        #linux\n-               OPTION(STONESENSE_INTERNAL_SO \"Link with prebuilt internal allegro libs and headers.\" ON)\n-               IF(STONESENSE_INTERNAL_SO)\n+               OPTION(ISOWORLD_INTERNAL_SO \"Link with prebuilt internal allegro libs and headers.\" ON)\n+               IF(ISOWORLD_INTERNAL_SO)\n                        FILE(DOWNLOAD http://dethware.org/dfhack/download/allegro509b.tar.bz2\n                                                  ${CMAKE_CURRENT_SOURCE_DIR}/allegro509b.tar.bz2\n                                                  EXPECTED_MD5 74ead5d95a83a03a301cdc76fa0a3df8)\n@@ -90,6 +90,8 @@ IF(UNIX)\n                                allegro_dialog\n                                allegro_image\n                                allegro_ttf\n+                               agui\n+                               agui_allegro5\n                                ${PROJECT_LIBS}\n                        )\n                ENDIF()\n```","files":null},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1468469102,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDcyMjQ3ODk1NQ=="},"added":["build"],"removed":[]},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1472001280,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI0MTkzMDI3MQ==","github-url":"https://github.com/DFHack/dfhack/issues/961#issuecomment-241930271"},"message":"@JapaMala, any ideas?","files":null},{"type":3,"author":{"id":"8eec94822f0cd94318fe65f78e120bf220e9fbf8"},"timestamp":1472004790,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI0MTkzODM5OA==","github-url":"https://github.com/DFHack/dfhack/issues/961#issuecomment-241938398"},"message":"I have no idea, really.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1472006639,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI0MTk0MjIzNA==","github-url":"https://github.com/DFHack/dfhack/issues/961#issuecomment-241942234"},"message":"Hm. How up-to-date is isoworld, anyway? I don't remember ever actually building it (although isoworldremote is a default plugin, so I've built that successfully).\n\n@TC01, what's the current state of that patch? Does it still fail to link the same symbols? Does Agui match the architecture you're building for?","files":null},{"type":3,"author":{"id":"8eec94822f0cd94318fe65f78e120bf220e9fbf8"},"timestamp":1472016762,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI0MTk2MTg3Nw==","github-url":"https://github.com/DFHack/dfhack/issues/961#issuecomment-241961877"},"message":"I relatively recently fixed loading maps with the new naming scheme, but I never even committed the changes, so no, it hasn't been updated in a very long time.","files":null},{"type":3,"author":{"id":"3777bd9464a985e5d5f5348b51d9318b5e1c4118"},"timestamp":1474859147,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI0OTQ2OTk2OA==","github-url":"https://github.com/DFHack/dfhack/issues/961#issuecomment-249469968"},"message":"@lethosor \n\nStill having the same issues with the above patch (now using Fedora 24 though). I just verified that everything fails when I have 32-bit Agui installed in a 32-bit chroot.\n\nI had to provide another patch for isoworld (probably due to a newer gcc / set of default compiler flags) to ensure \u003ccmath\u003e was included in a file (otherwise the compiler couldn't resolve the \"sqrt\" symbol) to get as far as the above linking failure at all though.\n\n``` diff\ndiff -rupN dfhack/plugins/isoworld/DetailedTile.cpp dfhack-fork/plugins/isoworld/DetailedTile.cpp\n--- dfhack/plugins/isoworld/DetailedTile.cpp    2016-09-25 22:58:38.603797808 -0400\n+++ dfhack-fork/plugins/isoworld/DetailedTile.cpp       2016-09-25 22:59:13.050852941 -0400\n@@ -4,6 +4,7 @@\n #include \"UserConfig.h\"\n #include \"ColorList.h\"\n #include \"TileSet.h\"\n+#include \u003ccmath\u003e\n #include \u003csstream\u003e\n\n using namespace isoworldremote;\n@@ -468,4 +469,4 @@ void load_detailed_tiles(ALLEGRO_PATH *\n     }\n     al_destroy_fs_entry(base_folder);\n     al_destroy_path(tile_path);\n-}\n\\ No newline at end of file\n+}\n```","files":null},{"type":3,"author":{"id":"fefd87bd170e69ba989c5932b26d53a6f30e8666"},"timestamp":1580233007,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3OTM2Nzc3NQ==","github-url":"https://github.com/DFHack/dfhack/issues/961#issuecomment-579367775"},"message":"I've fixed *some* of this in https://github.com/DFHack/isoworld/compare/fbbf9e46458e41707c27f2a4438452a579490db1...c2dad13d97dd9f5959e8761ac8a399f820f401b6, but I stopped because isoworld contains a precompiled 32-bit version of allegro and therefore won't link on 64-bit linux.","files":null},{"type":3,"author":{"id":"3777bd9464a985e5d5f5348b51d9318b5e1c4118"},"timestamp":1580233491,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDU3OTM3MTEzNA==","github-url":"https://github.com/DFHack/dfhack/issues/961#issuecomment-579371134"},"message":"I think I had deleted the prebuilt allegro and was trying to link against the system one-- but it's been a while, so I'm not entirely sure.","files":null}]}