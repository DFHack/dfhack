{"version":1,"ops":[{"type":1,"author":{"id":"003777c4d9d88966603d0ad7b3862f046087c9f7"},"timestamp":1585948238,"metadata":{"github-id":"MDU6SXNzdWU1OTM2NDI5Mjc=","github-url":"https://github.com/DFHack/dfhack/issues/1535","origin":"github"},"title":"Code style automation","message":"DFHack has a code style specification and developing would be easier if things around that were automated. A config for astyle and CI checks to make sure C++ files are formatted would cover it.\n```\n# \"One True Brace Style\"\n--style=1tbs\n\n# 4 spaces per indentation level and per tab stop\n--indent=spaces=4\n\n# replaces tabs with spaces in non-indent sections, except in strings\n--convert-tabs\n\n# force LF line endings\n--lineends=linux\n\n# attach brackets to class and struct inline function definitions.\n--attach-inlines\n\n# 'char *foo' instead of 'char* foo'\n--align-pointer=name\n\n# maximum length for a single unbroken line\n--max-code-length=100\n\n# 'foo ||\\nbar' instead of 'foo\\n|| bar'\n--break-after-logical\n\n# indent 'public:' 'protected:' 'private:' deeper than 'class' or 'struct'\n--indent-classes\n\n# indent 'case' lines deeper than 'switch'\n--indent-switches\n\n# indent later lines of multi-line preprocessor directives\n--indent-preproc-define\n\n# indent comments on column 1 to match the code block they are in\n--indent-col1-comments\n\n# indent multi-line control block headers like 'if (foo\\nbar)'\n--min-conditional-indent=0\n\n# add space around operators with two operands\n--pad-oper\n\n# add brackets to unbracketed one line conditional statements\n--add-brackets\n\n# remove extra space padding around parentheses\n--unpad-paren\n\n# insert space padding around parentheses on the inside only\n--pad-paren-in\n```\nThe first 4 options in there will make files meet the style guide in Contributing.rst except for sorting includes and file encoding. The rest aren't specified in the style guide but it's worth considering standardizing them.\n\nCI checks for formatting could use astyle with `--dry-run` to check if any files would be changed.","files":null}]}