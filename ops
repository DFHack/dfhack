{"version":1,"ops":[{"type":1,"author":{"id":"7af68b867d7e9be82b927775f5707b31435d423e"},"timestamp":1591038774,"metadata":{"github-id":"MDU6SXNzdWU2Mjg2NjI1NjQ=","github-url":"https://github.com/DFHack/dfhack/issues/1583","origin":"github"},"title":"Units.isMilkable true for whole race if any caste is milkable","message":"The [Units.isMilkable](https://github.com/DFHack/dfhack/blob/2fc7fa7ac2e56bffa5775e33fc3a3a8cafd6f364/library/modules/Units.cpp#L660) looks like the following.\n\n```c++\nbool Units::isMilkable(df::unit* unit)\n{\n    CHECK_NULL_POINTER(unit);\n    df::creature_raw *raw = world-\u003eraws.creatures.all[unit-\u003erace];\n    for (auto caste = raw-\u003ecaste.begin(); caste != raw-\u003ecaste.end(); ++caste)\n    {\n        if((*caste)-\u003eflags.is_set(caste_raw_flags::MILKABLE))\n            return true;\n    }\n    return false;\n}\n```\n\nI.e. what it does is check if **any** caste of unit's race is milkable and if so returns `true`. I think it should only return `true` when the actual caste of the unit is milkable.","files":null}]}