{"version":1,"ops":[{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1586529731,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxMjA1ODY2OA==","github-url":"https://github.com/DFHack/dfhack/issues/1544#issuecomment-612058668"},"message":"This might not be that hard to fix, actually. The feed() method gets a list of all interface_keys that are used, so you could ignore anything if a CURSOR_* key is present. However, those might also trigger with the default keybindings if the regular number keys are used... seems like a problem we've dealt with before, but I don't remember how off the top of my head.","files":null},{"type":6,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1586529731,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6MzY0Mzg0OTA5"},"target":"2cb7811a279280dc09cfcf0979c2f70883c4db7836d597ae6fc86f82dd9d43a9","message":"This might not be that hard to fix, actually. The feed() method gets a list of all interface_keys that are used, so it could do nothing in this case if a CURSOR_* key is present. However, those might also trigger with the default keybindings if the regular number keys are used... seems like a problem we've dealt with before, but I don't remember how off the top of my head.","files":null},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1586529743,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDMyMjIwNjIxMTc="},"added":["bug"],"removed":[]},{"type":3,"author":{"id":"d5dba9114ab58fdecab43b27f87ae959dac2c0c0"},"timestamp":1586617069,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxMjQzOTg5Mg==","github-url":"https://github.com/DFHack/dfhack/issues/1544#issuecomment-612439892"},"message":"Alright, I'll look into it sometime next week and see if I can figure it out.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1586655867,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxMjU0OTAxOQ==","github-url":"https://github.com/DFHack/dfhack/issues/1544#issuecomment-612549019"},"message":"[`tweak shift-8-scroll`](https://github.com/DFHack/dfhack/blob/develop/plugins/tweak/tweaks/shift-8-scroll.h) is one I thought of, but that's doing something else (resolving a conflict between a SECONDSCROLL and CURSOR key by picking the former).\n\nI don't have a numpad, so testing this is a bit tricky. One thing you could try: using [this script](https://github.com/lethosor/dfhack-scripts/blob/master/gui/input-monitor.lua), check what keys are produced when you press regular 1 vs numpad 1 (with as close to the default keybindings as possible). Hopefully at least something is different. If not, we may have to rework the interface to not conflict with numpad scrolling (e.g. by hiding these options in a submenu).","files":null},{"type":3,"author":{"id":"d5dba9114ab58fdecab43b27f87ae959dac2c0c0"},"timestamp":1587127015,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNTIyMDQ5NA==","github-url":"https://github.com/DFHack/dfhack/issues/1544#issuecomment-615220494"},"message":"It seems that both \"1\" and \"Numpad 1\" are bound to the same set of commands by default: A_CONV_PERSUADE, CURSOR_DOWNLEFT, A_MOVE_SW, STRING_A049, so no easy solution there. It seems putting the option in a submenu that inhibits navigation is the better option.\n\nAlso, while testing this, I have stumbled upon another bug: pressing \"Numpad 0\" while a viewscreen with auto-allocation is active causes the game to crash. GDB says: https://gist.github.com/Nilsolm/9355304f69134de2862f99e0a95d5484\n\nIt seems this part is the culprit:\nhttps://github.com/DFHack/dfhack/blob/8427f518c941f8e5734e98f2ff56648522f1281b/plugins/buildingplan.cpp#L196-L210\n\nNumpad 0 corresponds to STRING_A048 according to your script which I think is what's causing it. Not sure why the other plug-ins are throwing errors though.\n\nI'll see what I can do about this during the weekend.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1587153810,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNTQzOTU3Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1544#issuecomment-615439573"},"message":"Yeah, STRING_A048 shouldn't be allowed if the keys start at 1, and 0 would never be greater than np.size() so that check before `return false` would never fire.\nThe other plugins are showing up in the backtrace because those also interpose viewscreen_dwarfmodest::feed(). Multiple plugins can do this, so a call to INTERPOSE_NEXT will end up calling the next function in the chain, which could be either the native DF function or another plugin's function. In your case, the zone plugin called buildingplan code from [here](https://github.com/DFHack/dfhack/blob/c8ff8d0d8efa7a7c69658a30d18255a73c2955c8/plugins/zone.cpp#L4032), but the exact order depends on runtime factors like what order plugins were enabled in. (It usually shouldn't make a difference.)","files":null}]}