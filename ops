{"version":1,"ops":[{"type":6,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564380081,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1NTY3MTAwMA=="},"target":"f4b0dc337210c32eaaa9693a4bd2de129330f3a5ed0bf85c8cdb9d95d961814a","message":"OS: Arch Linux 4.19.61-1-lts x86_6\nDF Version: 0.44.12\nDFHACK: 0.44.12-r2\n\nDescription of issue:\nI am attempting to start dfhack from a desktop file but for some reason it will just open a window play the intro song for a second then close. I am trying to run it without a terminal as I use ctrl+shift+p and don't need the terminal.\n\nI am able to start dfhack from the terminal both directly with ./dfhack and with the start file listed below. Both run without issue.\n\nDesktop file:\n`[Desktop Entry]                                                                                                                                                                                \nEncoding=UTF-8                                                                                                                                                                                 \nName=Dwarf Fortress                                                                                                                                                                            \nGenericName=Dwarf Fortress                                                                                                                                                                     \nComment=A single player fortress management game.                                                                                                                                              \nExec=/home/xxx/Documents/dotfiles/.config/desktop/startdf                                                                                                                                                                                                                                                            \nTerminal=false                                                                                                                                                                                 \nType=Application                                                                                                                                                                               \nCategories=Game;`\n\nstartdf file:\n`DFHACK_DISABLE_CONSOLE=1 DFHACK_HEADLESS=1 /home/xxx/Downloads/df_linux/dfhack`\n\nI have attempted to add \u0026 to the end but that also has the same issue.\n\nAny ideas on what could be causing this would be helpful. This has worked without issue in the past but it now having this problem.","files":null},{"type":6,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564380146,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1NTY3MTMyNg=="},"target":"f4b0dc337210c32eaaa9693a4bd2de129330f3a5ed0bf85c8cdb9d95d961814a","message":"OS: Arch Linux 4.19.61-1-lts x86_6\nDF Version: 0.44.12\nDFHACK: 0.44.12-r2\n\nDescription of issue:\nI am attempting to start dfhack from a desktop file but for some reason it will just open a window play the intro song for a second then close. I am trying to run it without a terminal as I use ctrl+shift+p and don't need the terminal.\n\nI am able to start dfhack from the terminal both directly with ./dfhack and with the start file listed below. Both run without issue.\n\nDesktop file:\n`[Desktop Entry] `                                                                                                                                                                               \n`Encoding=UTF-8 `                                                                                                                                                                                \n`Name=Dwarf Fortress`                                                                                                                                                                          \n`GenericName=Dwarf Fortress`                                                                                                                                                                     \n`Comment=A single player fortress management game.`                                                                                                                                              \n`Exec=/home/xxx/Documents/dotfiles/.config/desktop/startdf `                                                                                                                                                                                                                                                           \n`Terminal=false`                                                                                                                                                                                 \n`Type=Application`                                                                                                                                                                               \n`Categories=Game;`\n\nstartdf file:\n`DFHACK_DISABLE_CONSOLE=1 DFHACK_HEADLESS=1 /home/xxx/Downloads/df_linux/dfhack`\n\nI have attempted to add \u0026 to the end but that also has the same issue.\n\nAny ideas on what could be causing this would be helpful. This has worked without issue in the past but it now having this problem.","files":null},{"type":6,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564435929,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1NjExOTI0NA=="},"target":"f4b0dc337210c32eaaa9693a4bd2de129330f3a5ed0bf85c8cdb9d95d961814a","message":"OS: Arch Linux 4.19.61-1-lts x86_6\nDF Version: 0.44.12\nDFHACK: 0.44.12-r2\n\nDescription of issue:\nI am attempting to start dfhack from a desktop file but for some reason it will just open a window play the intro song for a second then close. I am trying to run it without a terminal as I use ctrl+shift+p and don't need the terminal.\n\nI am able to start dfhack from the terminal both directly with ./dfhack and with the start file listed below. Both run without issue.\n\nDesktop file:\n`[Desktop Entry] `                                                                                                                                                                               \n`Encoding=UTF-8 `                                                                                                                                                                                \n`Name=Dwarf Fortress`                                                                                                                                                                          \n`GenericName=Dwarf Fortress`                                                                                                                                                                     \n`Comment=A single player fortress management game.`                                                                                                                                              \n`Exec=/home/xxx/Documents/dotfiles/.config/desktop/startdf `                                                                                                                                                                                                                                                           \n`Terminal=false`                                                                                                                                                                                 \n`Type=Application`                                                                                                                                                                               \n`Categories=Game;`\n\nstartdf file:\n`DFHACK_DISABLE_CONSOLE=1 /home/xxx/Downloads/df_linux/dfhack`\n\nI have attempted to add \u0026 to the end but that also has the same issue.\n\nAny ideas on what could be causing this would be helpful. This has worked without issue in the past but it now having this problem.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1564406932,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNTk5MTMyNQ==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-515991325"},"message":"Have you tried without DFHACK_HEADLESS? That's for systems that are actually headless (i.e. don't have a monitor at all). It's supposed to only turn off output in PRINT_MODE:TEXT, but maybe it affects other print modes as well.\n\n(Also note that not all commands work with ctrl-shift-p)","files":null},{"type":2,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1564406938,"metadata":{"github-id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjUxNjQ5OTA5Ng=="},"title":"DFHack failing to launch from desktop file","was":"DFHack failing to launch from desktop file"},{"type":3,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564435918,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNjE3MDYyOA==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-516170628"},"message":"Ahh that is my mistake I was testing to see if HEADLESS would allow it to launch and forgot to remove that. I have edited the original post to remove it. But yes confirmed it still does not work with DFHACK_HEADLESS removed. \n\nAlso yes I am aware that ctrl-shift-p doesn't work for everything but I can always launch it with the console or use dfhack-run.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1564452561,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNjIzMDM0Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-516230343"},"message":"So `DFHACK_DISABLE_CONSOLE=1 /home/xxx/Downloads/df_linux/dfhack` works from an existing terminal window? Maybe it's not picking up the window environment somehow when launched from your shortcut. You could try\n* wrapping it in a tmux or screen session and see if it does anything\n* removing stderr.log (same folder as `dfhack`) and seeing if it gets created","files":null},{"type":3,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564455282,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNjIzOTI2Mg==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-516239262"},"message":"It still does not work inside tmux, I removed the stderr.log file and it was recreated once I attempted to launch it. Here is the logs from the stderr.log. Unsure but it looks like it might still be attempting to launch the console based on the final line:\n\n`dfhack: hooking successful`\n`AL lib: (EE) ALCpulsePlayback_reset: Non-0 prebuf, 663 samples (5304 bytes), device has 990 samples`\n`DFHack build: 0.44.12-r2-0-g315852a2`\n`Identifying DF version.`\n`Loading hack/symbols.xml ... OK`\n`v0.44.12 SDL win32 (windows): PE: 0x5B41189F`\n`v0.44.12 SDL win64 (windows): PE: 0x5B41215D`\n`v0.44.12 linux32 (linux): MD5: ae16f7bf5af14396d4b0008238fbf636`\n`v0.44.12 linux64 (linux): MD5: 4b10f9ccb4a7f491be755c45ef2cc457`\n`v0.44.12 osx32 (darwin): MD5: b8f9fb6741e2845abb14071242e95bc0`\n`v0.44.12 osx64 (darwin): MD5: 2cc70426a2e9156d848b9f014622b55c`\n`Loaded 6 DF symbol tables.`\n`Version: v0.44.12 linux64`\n`Initializing Console.`","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1564455365,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNjIzOTQ5Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-516239493"},"message":"Huh. What if you set TERM=dumb in the script too?","files":null},{"type":3,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564455690,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNjI0MDQwOA==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-516240408"},"message":"ahh hold on I got a bit more info in the stderr.log the second time running it I think I see the issue. (skipping the loaded plugins as they are not showing any errors)\n\n`SDLreal.dll: cannot open shared object file: No such file or directory    `\n`SDL.framework/Versions/A/SDL: cannot open shared object file: No such file or directory `\n`SDL.framework/SDL: cannot open shared object file: No such file or directory `   \n`loaded plugin title-folder; DFHack build 0.44.12-r2-0-g315852a2`    \n`loading plugin forceequip`    \n`loaded plugin forceequip; DFHack build 0.44.12-r2-0-g315852a2 `","files":null},{"type":6,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564455690,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1NjIyODE5MA=="},"target":"5d67654d29df3734089d15cac0d456ae731a565d9f6c68b64d14889cc62090db","message":"ahh hold on I got a bit more info in the stderr.log the second time running it I think I see the issue. (skipping the loaded plugins as they are not showing any errors)\n\n`SDLreal.dll: cannot open shared object file: No such file or directory    `\n`SDL.framework/Versions/A/SDL: cannot open shared object file: No such file or directory `\n`SDL.framework/SDL: cannot open shared object file: No such file or directory `   \n`loaded plugin title-folder; DFHack build 0.44.12-r2-0-g315852a2`    \n`loading plugin forceequip`    \n`loaded plugin forceequip; DFHack build 0.44.12-r2-0-g315852a2 `\n\nAlso trying setting the term now","files":null},{"type":3,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564455768,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNjI0MDc0MQ==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-516240741"},"message":"Still crashes with setting the TERM=dumb","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1564456021,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNjI0MTUzNA==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-516241534"},"message":"Those errors are meaningless. It's trying to load the SDL libraries for Windows and macOS, and there's unfortunately no easy way to silence those errors (dlopen always prints them).\nAny other output from stderr.log with TERM=dumb? Does it always show plugin loading messages, or did it not show any the first time?","files":null},{"type":3,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564456396,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNjI0MjgzOQ==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-516242839"},"message":"Good to know.\n\noutput is the same with TERM=dumb and without. (double checked using diff)\n\nYes the first time it did not show the plugins loading, unsure as to why but it is showing with all the plugins loading now and I have ran it several times and it always is showing the plugins loading each time. My PC did crash shortly after so might have been something going on with my computer unrelated to dfhack.","files":null},{"type":3,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564693856,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNzQ1ODk3NQ==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-517458975"},"message":"Alright so I ran a few test today and it looks like the disable console is broken in the DFHack 0.44.12-r2 release. I followed the same steps of installing with both DFHack 0.44.12-r2 and DFHack 0.44.12-r1. DFHack 0.44.12-r2 starts for 1 second then closes, DFHack 0.44.12-r1 runs without issue. \nLooks like something got changed between R1 and r2. I did notice these lines have changed here in R2 and R1\nR2: https://github.com/DFHack/dfhack/blob/195db1bad9697f75672838127ad435112ee72491/library/Core.cpp#L1481\nR1 https://github.com/DFHack/dfhack/blob/c2a64b3573abbee549761f5c1c2626eec7a6e81c/library/Core.cpp#L1708\n\nMight be the cause but I am not very familiar with cpp.","files":null},{"type":6,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564693856,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1ODAwNTk4Nw=="},"target":"2542f2951b420d0c3e0c7ab41634901bd90b48b2c2974b9a9bfb2037075598d0","message":"Alright so I ran a few test today and it looks like the disable console is broken in the DFHack 0.44.12-r2 release. I followed the same steps of installing with both DFHack 0.44.12-r2 and DFHack 0.44.12-r1. DFHack 0.44.12-r2 starts for 1 second then closes, DFHack 0.44.12-r1 runs without issue. \nLooks like something got changed between R1 and r2. I did notice these lines have changed here in R2 and R1\nR2: https://github.com/DFHack/dfhack/blob/195db1bad9697f75672838127ad435112ee72491/library/Core.cpp#L1481-L1483\nR1: https://github.com/DFHack/dfhack/blob/c2a64b3573abbee549761f5c1c2626eec7a6e81c/library/Core.cpp#L1708-L1711\n\nMight be the cause but I am not very familiar with cpp.","files":null},{"type":6,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1564715084,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1ODEzNzk5Ng=="},"target":"2542f2951b420d0c3e0c7ab41634901bd90b48b2c2974b9a9bfb2037075598d0","message":"Alright so I ran a few test today and it looks like the disable console is broken in the DFHack 0.44.12-r2 release. I followed the same steps of installing with both DFHack 0.44.12-r2 and DFHack 0.44.12-r1. DFHack 0.44.12-r2 starts for 1 second then closes, DFHack 0.44.12-r1 runs without issue. \nLooks like something got changed between R1 and r2. I did notice these lines have changed here in R2 and R1\nR2: https://github.com/DFHack/dfhack/blob/0.44.12-r2/library/Core.cpp#L1481-L1483\nR1: https://github.com/DFHack/dfhack/blob/0.44.12-r1/library/Core.cpp#L1708-L1711\n\nMight be the cause but I am not very familiar with cpp.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1564715363,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNzUzMDU4OA==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-517530588"},"message":"Yeah, it was changed between r1 and r2 to fix issues with running DF+DFHack on Travis (i.e. an actual system). The check for DFHACK_DISABLE_CONSOLE got moved to an entirely different place, but as a result, the console is actually getting initialized. The only time it isn't getting initialized is when you've specified PRINT_MODE:TEXT *and* run with DFHACK_HEADLESS, the first of which isn't a great option for you.\n\nFor now, I would recommend starting it with a terminal and just ignoring the terminal. I'll try to put up a fix and a test build you can try out (unless you want to compile the fixed build yourself).\n\nI also tried changing your links to use the tags in the URL to be a bit clearer, although apparently that doesn't show the previews any more... (at any rate, any release in the URL should work in place of a commit, or you can browse a release by clicking on the branch dropdown on any file page and clicking \"tags\", which should take you to a page like [this](https://github.com/DFHack/dfhack/tree/0.44.12-r2))","files":null},{"type":6,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1564715363,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1ODEzOTM2Nw=="},"target":"d045f632c00dbb57a0e97855ea1072d704037deabd0f9dc980a0ede40edaa479","message":"Yeah, it was changed between r1 and r2 to fix issues with running DF+DFHack on Travis (i.e. an actual headless system). The check for DFHACK_DISABLE_CONSOLE got moved to an entirely different place, but as a result, the console is actually getting initialized. The only time it isn't getting initialized is when you've specified PRINT_MODE:TEXT *and* run with DFHACK_HEADLESS, the first of which isn't a great option for you.\n\nFor now, I would recommend starting it with a terminal and just ignoring the terminal. I'll try to put up a fix and a test build you can try out (unless you want to compile the fixed build yourself).\n\nI also tried changing your links to use the tags in the URL to be a bit clearer, although apparently that doesn't show the previews any more... (at any rate, any release in the URL should work in place of a commit, or you can browse a release by clicking on the branch dropdown on any file page and clicking \"tags\", which should take you to a page like [this](https://github.com/DFHack/dfhack/tree/0.44.12-r2))","files":null},{"type":6,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1564715444,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDI1ODEzOTc2NQ=="},"target":"d045f632c00dbb57a0e97855ea1072d704037deabd0f9dc980a0ede40edaa479","message":"Yeah, it was changed between r1 and r2 to fix issues with running DF+DFHack on Travis (i.e. an actual headless system). The check for DFHACK_DISABLE_CONSOLE got moved to an entirely different place, but as a result, the console is actually getting initialized, which I guess locks up when there isn't a TTY to connect to ([this](https://github.com/DFHack/dfhack/blob/0.44.12-r2/library/Console-posix.cpp#L833) tries to open the TTY which could be the issue). The only time it isn't getting initialized is when you've specified PRINT_MODE:TEXT *and* run with DFHACK_HEADLESS, the first of which isn't a great option for you.\n\nFor now, I would recommend starting it with a terminal and just ignoring the terminal. I'll try to put up a fix and a test build you can try out (unless you want to compile the fixed build yourself).\n\nI also tried changing your links to use the tags in the URL to be a bit clearer, although apparently that doesn't show the previews any more... (at any rate, any release in the URL should work in place of a commit, or you can browse a release by clicking on the branch dropdown on any file page and clicking \"tags\", which should take you to a page like [this](https://github.com/DFHack/dfhack/tree/0.44.12-r2))","files":null},{"type":3,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1564728799,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDUxNzU3ODU4Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-517578583"},"message":"Either way is fine I can compile it myself if needed.\n\nAlso thanks for the tips with the URL, still getting used to git and github. \n\nI appreciate the help with this issue, it has been bugging me for a while.","files":null},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1565474377,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDI1NDgzNjQ3MTY="},"added":["bug"],"removed":[]},{"type":3,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1587006818,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNDM5MTM2OA==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-614391368"},"message":"Just comfirmed bug is fixed in the latest update. Thanks for getting this all taken care of!","files":null},{"type":4,"author":{"id":"0614302375b7631a145068dec97402f5d726b605"},"timestamp":1587006818,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MzIzODAyMTg3NQ=="},"status":2},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1587006998,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNDM5MjI0Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1449#issuecomment-614392243"},"message":"Oh, this must have been the same issue as #1477, then - cool!","files":null},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1587007006,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDMyMzgwMjcwMjg="},"added":["crash/hang"],"removed":[]}]}