{"version":1,"ops":[{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1600277053,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY5MzU0Nzk5Nw==","github-url":"https://github.com/DFHack/dfhack/issues/1649#issuecomment-693547997"},"message":"How are you launching DFHack? If you're not already, can you try running it with `./dfhack` from an existing terminal (after navigating to your DF folder)?","files":null},{"type":6,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1600277053,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6NDAwNDkxOTQ0"},"target":"9ca08a724d583b62bdad0a850ecc7127bd9577ac4d4b8f0f101619732700d2a4","message":"How are you launching DFHack? If you're not already, can you try running it with `./dfhack` from an existing terminal (after navigating to your DF folder)?\n\nIf DFHack is running, you should also see a \"DFHack\" indicator in the upper left corner of the title screen (probably just one line on your end):\n\n![image](https://user-images.githubusercontent.com/3719547/93371144-e05bab00-f81f-11ea-9700-1064facbece7.png)","files":null},{"type":3,"author":{"id":"41f97ffdd57eadbb0959fe5adcc591e26de613fa"},"timestamp":1600278500,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY5MzU2MTI0Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1649#issuecomment-693561243"},"message":"Yes I am launching it from an existing terminal using the ./dfhack","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1600278848,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY5MzU2NDQzMA==","github-url":"https://github.com/DFHack/dfhack/issues/1649#issuecomment-693564430"},"message":"Is there any output in the terminal after you start DFHack? Can you upload your stderr.log?","files":null},{"type":3,"author":{"id":"41f97ffdd57eadbb0959fe5adcc591e26de613fa"},"timestamp":1600279903,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY5MzU2OTM5OA==","github-url":"https://github.com/DFHack/dfhack/issues/1649#issuecomment-693569398"},"message":"![Screen Shot 2020-09-16 at 10 58 45 AM](https://user-images.githubusercontent.com/12091471/93374870-2eff4a00-f80c-11ea-83a6-246a18020dce.png)\nHere is what shows up when Launching. There is no stderr.log in the df folder where I am running hack from.","files":null},{"type":6,"author":{"id":"41f97ffdd57eadbb0959fe5adcc591e26de613fa"},"timestamp":1600279903,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6NDAwNTAyMzk5"},"target":"ffd078c5cbaabdbeb800fe4c8570218fb1cade58b2955fc11436cad8e4a5310e","message":"![Screen Shot 2020-09-16 at 10 58 45 AM](https://user-images.githubusercontent.com/12091471/93374870-2eff4a00-f80c-11ea-83a6-246a18020dce.png)\nHere is what shows up when Launching. There is no stderr.log in the df folder where I am running hack from. \n\nEDIT: Maybe this is something due to the lastest version of catalina? I am running bash even tho the terminal complains that I should swich to zsh..","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1600285015,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY5MzYyMjgyMA==","github-url":"https://github.com/DFHack/dfhack/issues/1649#issuecomment-693622820"},"message":"The dfhack script uses bash regardless of what your system shell is. What DFHack version are you using? https://github.com/DFHack/dfhack/pull/1606 was intended to fix some Catalina issues and is part of 0.47.04-r2.\nCould you also try running ./dfhack-run? It won't do anything, but I'm wondering if a gatekeeper error will come up.","files":null},{"type":3,"author":{"id":"41f97ffdd57eadbb0959fe5adcc591e26de613fa"},"timestamp":1600285369,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY5MzYyNTQxMQ==","github-url":"https://github.com/DFHack/dfhack/issues/1649#issuecomment-693625411"},"message":"I am running 0.47.04-r2 \nWhen I run dfhack-run I get the below. \n\n`:\u003e ./dfhack-run\nUsage: dfhack-run \u003ccommand\u003e [args...]\n\nNote: this command does not start DFHack; it is intended to connect\nto a running DFHack instance. If you were trying to start DFHack, run\n   ./dfhack\nor see the documentation in hack/docs/index.html for more help.\n:\u003e `","files":null},{"type":6,"author":{"id":"41f97ffdd57eadbb0959fe5adcc591e26de613fa"},"timestamp":1600285369,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6NDAwNTIzNTM2"},"target":"2593191993503112ccd2b8b9ebb1c20f6cf490ba80ec5249e6f336330c41b0fd","message":"I am running 0.47.04-r2 \nWhen I run dfhack-run I get the below. \n\n```\n:\u003e ./dfhack-run\nUsage: dfhack-run \u003ccommand\u003e [args...]\n\nNote: this command does not start DFHack; it is intended to connect\nto a running DFHack instance. If you were trying to start DFHack, run\n   ./dfhack\nor see the documentation in hack/docs/index.html for more help.\n:\u003e \n```","files":null},{"type":6,"author":{"id":"41f97ffdd57eadbb0959fe5adcc591e26de613fa"},"timestamp":1600285439,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6NDAwNTIzNzYx"},"target":"2593191993503112ccd2b8b9ebb1c20f6cf490ba80ec5249e6f336330c41b0fd","message":"I am running 0.47.04-r2 \nWhen I run dfhack-run I get the below. \nI think its possible that the script is not starting the program correctly but its hard to tell, macosx is not the most helpfull os when dealing with this type of thing. \n\n```\n:\u003e ./dfhack-run\nUsage: dfhack-run \u003ccommand\u003e [args...]\n\nNote: this command does not start DFHack; it is intended to connect\nto a running DFHack instance. If you were trying to start DFHack, run\n   ./dfhack\nor see the documentation in hack/docs/index.html for more help.\n:\u003e \n```","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1600285532,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY5MzYyNjg0Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1649#issuecomment-693626843"},"message":"Ok, that's good. Can you post the contents of your `dfhack` script?","files":null},{"type":3,"author":{"id":"41f97ffdd57eadbb0959fe5adcc591e26de613fa"},"timestamp":1600285837,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY5MzYyOTI2Mg==","github-url":"https://github.com/DFHack/dfhack/issues/1649#issuecomment-693629262"},"message":"Sure I did not modify it from what I remember other then checking to make sure it did not contain any ^M at every line end like the soundsense one has that makes it not work. \n\n```\n#!/bin/sh\nPWD=`dirname \"${0}\"`\ncd \"${PWD}\"\n#thanks to Iriel for figuring this out\nOSREV=`uname -r | cut -d. -f1`\nif [ \"$OSREV\" -ge 11 ] ; then\n\texport DYLD_LIBRARY_PATH=\"./hack:./libs:./hack/libs\"\n\texport DYLD_FRAMEWORK_PATH=\"./hack:./libs:./hack/libs\"\nelse\n\texport DYLD_FALLBACK_LIBRARY_PATH=\"./hack:./libs:./hack/libs\"\n\texport DYLD_FALLBACK_FRAMEWORK_PATH=\"./hack:./libs:./hack/libs\"\nfi\n\n# attempt to remove quarantine flag: https://github.com/DFHack/dfhack/issues/1465\nif ! test -f hack/quarantine-removed; then\n    find hack/ libs/ dwarfort.exe \\( -name '*.dylib' -or -name '*.framework' -or -name '*.exe' \\) -print0 | xargs -0 xattr -d com.apple.quarantine 2\u003e\u00261 | grep -iv 'no such xattr'\n    echo \"quarantine flag removed on $(date); remove this file to re-run\" \u003e hack/quarantine-removed\nfi\n\nif [ ! -t 0 ]; then\n    stty() {\n        return\n    }\nfi\n\nold_tty_settings=$(stty -g)\nDYLD_INSERT_LIBRARIES=./hack/libdfhack.dylib ./dwarfort.exe \"$@\"\nstty \"$old_tty_settings\"\ntput sgr0\necho \"\"\n```","files":null},{"type":3,"author":{"id":"41f97ffdd57eadbb0959fe5adcc591e26de613fa"},"timestamp":1600287635,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY5MzY0MzczNA==","github-url":"https://github.com/DFHack/dfhack/issues/1649#issuecomment-693643734"},"message":"LOL disregard this.... My AV was blocking this because it interacts with memory in another application so it thought it was some kind of virus. I will need to mark it as OK to do this. Sorry for leading anyone down a rabbit hole.","files":null},{"type":4,"author":{"id":"41f97ffdd57eadbb0959fe5adcc591e26de613fa"},"timestamp":1600287635,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50Mzc3NDkxOTY1Ng=="},"status":2},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1600288085,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY5MzY0NzMxMg==","github-url":"https://github.com/DFHack/dfhack/issues/1649#issuecomment-693647312"},"message":"Interesting. DFHack actually doesn't interact with memory in *another* application (it runs in the same process as DF), but the technique it uses to inject itself into DF (DYLD_INSERT_LIBRARIES in the dfhack script) could conceivably be used by malware. I'm not sure how any third-party antivirus software could prevent it from working, but the OS could probably prevent it, and that would keep DFHack from being able to initialize, which would match the behavior you saw.\n(Hopefully that's helpful if you need to disable a specific AV feature if whitelisting DFHack isn't enough)","files":null}]}