{"version":1,"ops":[{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1481301397,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDg4ODU4NzAzOQ=="},"added":["bug"],"removed":[]},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1483378859,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI3MDAwMDg1Ng==","github-url":"https://github.com/DFHack/dfhack/issues/1013#issuecomment-270000856"},"message":"Could be related to #779.\n\nEdit: it seems unpredictable. Saving a stockpile with sheets in 0.43, then loading it in 0.43 works, but loading it in 0.42 does not (for example; there are other failures as well).","files":null},{"type":3,"author":{"id":"702387a998b76771bd3f3474fa84eeb77622a5db"},"timestamp":1524728638,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM4NDU0NTM3Mg==","github-url":"https://github.com/DFHack/dfhack/issues/1013#issuecomment-384545372"},"message":"Will look into this!","files":null},{"type":2,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1597799247,"metadata":{"github-id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MzY2ODY1MzgxMw=="},"title":"stockpiles fails to serialize furniture stockpiles","was":"stockpiles fails to serialize furniture stockpiles"},{"type":2,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1597799255,"metadata":{"github-id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MzY2ODY1NDA4NA=="},"title":"stockpiles fails to serialize furniture/sheets stockpiles","was":"stockpiles fails to serialize furniture stockpiles"},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1597799917,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY3NTc5Mzk3Ng==","github-url":"https://github.com/DFHack/dfhack/issues/1013#issuecomment-675793976"},"message":"Enabling the \"furniture/siege ammo\" category in 0.47.04-r2 (Linux) and attempting to save now gives a different error:\n```\nserialization failed: protobuf exception: CHECK failed: (bytes_produced_by_serialization) == (byte_size_before_serialization): Byte size calculation and serialization were inconsistent.  This may indicate a bug in protocol buffers or it may be caused by concurrent modification of the message.\n```\nThe \"sheets\" category appears to be ignored entirely.","files":null},{"type":6,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1597799917,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6Mzk0MDU3MDE3"},"target":"c3b25f6ad7aed5a22f5590d0135d62ad86c2bbd9887b22950578a79e635840ef","message":"Enabling the \"furniture/siege ammo\" category in 0.47.04-r2 (Linux) and attempting to save now gives a different error:\n```\nserialization failed: protobuf exception: CHECK failed: (bytes_produced_by_serialization) == (byte_size_before_serialization): Byte size calculation and serialization were inconsistent.  This may indicate a bug in protocol buffers or it may be caused by concurrent modification of the message.\n```\nThe \"sheets\" category appears to be ignored entirely (per #779)","files":null},{"type":2,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1597799871,"metadata":{"github-id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MzY2ODY3Mjk2MQ=="},"title":"stockpiles fails to serialize furniture stockpiles","was":"stockpiles fails to serialize furniture/sheets stockpiles"},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1597811107,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY3NTg0Mjc4MQ==","github-url":"https://github.com/DFHack/dfhack/issues/1013#issuecomment-675842781"},"message":"Commenting out this line appears to fix the issue: https://github.com/DFHack/dfhack/blob/0.47.04-r2/plugins/stockpiles/StockpileSerializer.cpp#L831","files":null},{"type":6,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1597811107,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6Mzk0MDg1MDY0"},"target":"3c1f6557e56bf31b4054fc220c15937fc6504ba96b9701a2fc437cdc9796c86d","message":"Commenting out this line appears to fix the issue: https://github.com/DFHack/dfhack/blob/0.47.04-r2/plugins/stockpiles/StockpileSerializer.cpp#L831\nSAND_BAG is in furniture_type now, so this check may not be necessary. Changing the `sand_bags` field doesn't appear to change the stockpile settings, and setting _MALLOC_PERTURB indicates that it's uninitialized, so maybe it just isn't used anymore.","files":null},{"type":6,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1597884205,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6Mzk0MzYwNDU2"},"target":"3c1f6557e56bf31b4054fc220c15937fc6504ba96b9701a2fc437cdc9796c86d","message":"Commenting out this line appears to fix the issue: https://github.com/DFHack/dfhack/blob/0.47.04-r2/plugins/stockpiles/StockpileSerializer.cpp#L831\nSAND_BAG is in furniture_type now, so this check may not be necessary. Changing the `sand_bags` field doesn't appear to change the stockpile settings, and setting MALLOC_PERTURB_ indicates that it's uninitialized, so maybe it just isn't used anymore.","files":null},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1597985061,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDM2NzgwMDgxNjc="},"added":["stockpiles"],"removed":[]},{"type":4,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1598746019,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MzcwNjg5ODk2Nw=="},"status":2},{"type":3,"author":{"id":"702387a998b76771bd3f3474fa84eeb77622a5db"},"timestamp":1598805981,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY4MzQ0MjkxOA==","github-url":"https://github.com/DFHack/dfhack/issues/1013#issuecomment-683442918"},"message":"Thanks @lethosor !","files":null}]}