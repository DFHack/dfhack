{"version":1,"ops":[{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1586907708,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDMyMzMyODY4Mzc="},"added":["bug"],"removed":[]},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1586907708,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDMyMzMyODY4Mzg="},"added":["ruby"],"removed":[]},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1586915681,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxMzc2OTgyNA==","github-url":"https://github.com/DFHack/dfhack/issues/1549#issuecomment-613769824"},"message":"I was unable to reproduce on Linux with unicode characters in the DF path, a custom script path, and within the script itself, so this appears to be Windows-specific.","files":null},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1586915685,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDMyMzM1MjQwNDI="},"added":["os-specific"],"removed":[]},{"type":3,"author":{"id":"df7feee793b3a4f60453609739052ef8e882d092"},"timestamp":1587025016,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNDQ5MDE4OQ==","github-url":"https://github.com/DFHack/dfhack/issues/1549#issuecomment-614490189"},"message":"Replicated LordBalkan's problem on Windows 10.1, 64 bit:\n\n´´´E: Encoding::ConverterNotFoundError: code converter not found (ASCII-8BIT to UTF-8)\n eval:1:in `require'\n eval:1:in `\u003cmain\u003e'\nTWBT: version 6.xx\nTWBT: set PRINT_MODE to TWBT in data/init/init.txt to activate the plugin\nE: NoMethodError: undefined method `onstatechange' for DFHack:Module\n eval:1:in `\u003cmain\u003e'\nE: NoMethodError: undefined method `onstatechange' for DFHack:Module\n eval:1:in `\u003cmain\u003e'\nmultilevel is not a recognized command.\nDFHack is ready. Have a nice day!\nDFHack version 0.47.04-beta1 (release) on x86_64\nType in '?' or 'help' for general help, 'ls' to see all commands.\n[DFHack]#\n´´´\nwhen changing \"Games\" to \"Gãmes\" in the path.  The TwbT stuff is irrelevant, of course. I've stopped using it again (due to crashes that may or may not have been related to TwbT).","files":null},{"type":6,"author":{"id":"df7feee793b3a4f60453609739052ef8e882d092"},"timestamp":1587025016,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6MzY1NTM0NTU1"},"target":"a0e46a22a05bb508c5322c6c09d9bdde0eb412f48aa9d395cdcef6a146078b10","message":"Replicated LordBalkan's problem on Windows 10.1, 64 bit:\n\n´´´E: Encoding::ConverterNotFoundError: code converter not found (ASCII-8BIT to UTF-8)\n eval:1:in `require'\n eval:1:in `\u003cmain\u003e'\nTWBT: version 6.xx\nTWBT: set PRINT_MODE to TWBT in data/init/init.txt to activate the plugin\nE: NoMethodError: undefined method `onstatechange' for DFHack:Module\n eval:1:in `\u003cmain\u003e'\nE: NoMethodError: undefined method `onstatechange' for DFHack:Module\n eval:1:in `\u003cmain\u003e'\nmultilevel is not a recognized command.\nDFHack is ready. Have a nice day!\nDFHack version 0.47.04-beta1 (release) on x86_64\nType in '?' or 'help' for general help, 'ls' to see all commands.\n[DFHack]#\n´´´\nwhen changing \"Games\" to \"Gãmes\" in the path.  The TwbT stuff is irrelevant, of course. I've stopped using it again (due to crashes that may or may not have been related to TwbT).\n\nInterestingly enough, my first attempt with \"Gåmes\" didn't result in any issues.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1587047474,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNDY5MDA1Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1549#issuecomment-614690053"},"message":"Interesting, I'll try some other characters on Linux. Could you try running `type startdwarf` in the broken setup and see if that gives you the correct path?","files":null},{"type":3,"author":{"id":"df7feee793b3a4f60453609739052ef8e882d092"},"timestamp":1587051005,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNDcyNDA5Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1549#issuecomment-614724093"},"message":"Interesting... I changed the path, started the pyLNP console, and launched DF without problem. Killed it and started DF from the DF directory directly and it complained. In that state, typing \"startdwarf\" before anything is launched results in this (after the stuff above):\n´´´\n[DFHack]# startdwarf\nE: Encoding::ConverterNotFoundError: code converter not found (ASCII-8BIT to UTF-8)\n eval:2:in `load'\n eval:2:in `block in \u003cmain\u003e'\n eval:2:in `catch'\n eval:2:in `\u003cmain\u003e'\n[DFHack]#\n´´´","files":null},{"type":6,"author":{"id":"df7feee793b3a4f60453609739052ef8e882d092"},"timestamp":1587051005,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6MzY1NjM5NjY0"},"target":"ec515da42e2066a379e035ad28ea80ed4e67fc047bd9bdf4f8a006b706a3f8f6","message":"Interesting... I changed the path, started the pyLNP console shortcut, and launched DF without problem. Killed it and started DF from the DF directory directly and it complained. In that state, typing \"startdwarf\" before anything is launched results in this (after the stuff above):\n´´´\n[DFHack]# startdwarf\nE: Encoding::ConverterNotFoundError: code converter not found (ASCII-8BIT to UTF-8)\n eval:2:in `load'\n eval:2:in `block in \u003cmain\u003e'\n eval:2:in `catch'\n eval:2:in `\u003cmain\u003e'\n[DFHack]#\n´´´","files":null},{"type":3,"author":{"id":"fefd87bd170e69ba989c5932b26d53a6f30e8666"},"timestamp":1587056137,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNDc3MjIyOA==","github-url":"https://github.com/DFHack/dfhack/issues/1549#issuecomment-614772228"},"message":"/cc @jjyg","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1587064591,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNDg0NTQwOA==","github-url":"https://github.com/DFHack/dfhack/issues/1549#issuecomment-614845408"},"message":"@PatrikLundell I meant run the command `type startdwarf`, which should give you the path to the script (instead of running it). I'm curious if that's the part that's breaking.\n(The `type` command is taken from bash; maybe we should come up with another name that's less confusing...)","files":null},{"type":3,"author":{"id":"df7feee793b3a4f60453609739052ef8e882d092"},"timestamp":1587066148,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNDg1NzMxMw==","github-url":"https://github.com/DFHack/dfhack/issues/1549#issuecomment-614857313"},"message":"´´´\n[DFHack]# type startdwarf\nstartdwarf is a Ruby script: C:\\Gπmes\\Dwarf Fortress\\Dwarf Fortress 47_04 Starter Pack r01\\Dwarf Fortress 0.47.04/hack/scripts/startdwarf.rb\n´´´","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1587089095,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNDk5Njg1Mg==","github-url":"https://github.com/DFHack/dfhack/issues/1549#issuecomment-614996852"},"message":"I had forgotten that I had script paths set up so that all of the scripts were being located in ../../dfhack/scripts. But even after removing that and adding an `ã` to my DF path, I was unable to reproduce the issue (on Linux).\nPotentially related: We bundle Ruby 2.0.0 on win64, but Ruby 1.8.7 everywhere else (except on osx64, where we fall back to the system-provided Ruby, which should be 2.x these days).","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1587089563,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYxNDk5OTAxOQ==","github-url":"https://github.com/DFHack/dfhack/issues/1549#issuecomment-614999019"},"message":"I tried Ruby 2.7 on Linux. Scripts still seem to work, but when the directory contains ã, it complains about the error handling:\n\nASCII only:\n```\n[DFHack]# multicmd foo;bar\nfoo is not a recognized command.\nbar is not a recognized command.\n```\n\nWith ã:\n```\n[DFHack]# multicmd foo;bar\nE: SyntaxError: eval:2: syntax error, unexpected local variable or method, expecting ']'\ncatch(:script_finished) { load '.....\n^~~~~\n\nfoo is not a recognized command.\nbar is not a recognized command.\n```","files":null}]}