{"version":1,"ops":[{"type":1,"author":{"id":"d4ba99f16422e9377de56dab81d2b84415f00388"},"timestamp":1598189303,"metadata":{"github-id":"MDU6SXNzdWU2ODQxODM3NjI=","github-url":"https://github.com/DFHack/dfhack/issues/1631","origin":"github"},"title":"exportlegends: `art_id` is u16 maximum value","message":"While testing I found another value that is incorrect.\nFor a HE with type `masterpiece_created_item_improvement` there is a field `art_id`.\nI think this refers to artifact id, but the value is 65535 with is the maximum value of a unsigned 16bit integer (2^16-1).\nSo I think someone wanted to set this value to `-1` but it warped around.\n\n```xml\n\u003chistorical_event\u003e\n        \u003cid\u003e68953\u003c/id\u003e\n        \u003ctype\u003emasterpiece_created_item_improvement\u003c/type\u003e\n        \u003cmaker\u003e11112\u003c/maker\u003e\n        \u003cmaker_entity\u003e1411\u003c/maker_entity\u003e\n        \u003csite\u003e391\u003c/site\u003e\n        \u003cunk_1\u003e-65524\u003c/unk_1\u003e\n        \u003citem_type\u003ebar\u003c/item_type\u003e\n        \u003citem_subtype\u003e-1\u003c/item_subtype\u003e\n        \u003cmat_type\u003e31\u003c/mat_type\u003e\n        \u003cmat_index\u003e3127\u003c/mat_index\u003e\n        \u003cunk_2\u003e1\u003c/unk_2\u003e\n        \u003cimprovement_type\u003eunknown -1\u003c/improvement_type\u003e\n        \u003cimprovement_subtype\u003e0\u003c/improvement_subtype\u003e\n        \u003cimp_mat_type\u003e29\u003c/imp_mat_type\u003e\n        \u003cimp_mat_index\u003e-1\u003c/imp_mat_index\u003e\n        \u003cart_id\u003e65535\u003c/art_id\u003e\n        \u003cart_subid\u003e0\u003c/art_subid\u003e\n\u003c/historical_event\u003e\n```\n\nI also don't know what `art_subid` is supposed to be? There are also some `unk_1` and `unk_2` tags. They are unknown values?\n`unk_1` also looks odd `-65524` maybe that should be 65535-65524=11?\n\n`improvement_type` has a value of `unknown -1` maybe better to change it to `-1` or `unknown`?\n\nRelated issue: https://gitlab.com/df_storyteller/df-storyteller/-/issues/88","files":null}]}