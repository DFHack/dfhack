{"version":1,"ops":[{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1524324569,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM4MzMwNTI5Ng==","github-url":"https://github.com/DFHack/dfhack/issues/1260#issuecomment-383305296"},"message":"This is expected. You're passing Ui to defclass, so it copies all fields from the old Ui table first.","files":null},{"type":3,"author":{"id":"df7feee793b3a4f60453609739052ef8e882d092"},"timestamp":1524326574,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM4MzMwODkwMg==","github-url":"https://github.com/DFHack/dfhack/issues/1260#issuecomment-383308902"},"message":"Thanks for the answer. In case someone else digs this up and is interested, the explanation led me to dig around and find a work around: add \"Ui = {}\" before the line calling defclass to make sure you're wiping any old garbage before (re)defining the class.\nThat part of the script comes from copying how gui/gm-editor does its UI, by the way.","files":null},{"type":4,"author":{"id":"df7feee793b3a4f60453609739052ef8e882d092"},"timestamp":1524326574,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MTU4NzUxMjk2OQ=="},"status":2},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1524327030,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM4MzMwOTQzMQ==","github-url":"https://github.com/DFHack/dfhack/issues/1260#issuecomment-383309431"},"message":"Or just `defclass(nil, parent)` would work (or maybe `defclass({}, parent)`).","files":null},{"type":3,"author":{"id":"df7feee793b3a4f60453609739052ef8e882d092"},"timestamp":1524327884,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDM4MzMxMDQwOA==","github-url":"https://github.com/DFHack/dfhack/issues/1260#issuecomment-383310408"},"message":"Hm, yes. nil worked and is a much better alternative. I must have misread the defclass script, as I got the impression there was a check to reject nil.","files":null},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1526323489,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDE2MjU1MzY1Mzc="},"added":["lua"],"removed":[]},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1526323489,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDE2MjU1MzY1NDA="},"added":["out of scope"],"removed":[]}]}