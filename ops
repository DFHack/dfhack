{"version":1,"ops":[{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1502717808,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMyMjE5MTgyMg==","github-url":"https://github.com/DFHack/dfhack/issues/1151#issuecomment-322191822"},"message":"Have you tried disabling *everything* to make sure it's a DFHack thing? (`unload -all` to be sure.) Sometimes in large worlds, DF itself can be the cause of behavior like that.\n\nFor plugins, try timing individual plugins in PluginManager::OnUpdate() in PluginManager.cpp. For scripts, getting names of timers might be harder, but check out run_timers() in LuaTools.cpp. (I'm not sure about Ruby, but it should be in ruby/ruby.cpp in any case.)","files":null},{"type":3,"author":{"id":"6879b8f55db2bdc58a4a5acfa01cd947d04b59d2"},"timestamp":1502747812,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMyMjMyMTA0Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1151#issuecomment-322321043"},"message":"Oohhh.. I was afraid it was in the .cpp.   What's required to develop the c++ components?  Does it require a microsoft dev environment?\n\nWe shall try unload -all first.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1502750125,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMyMjMyODY1NQ==","github-url":"https://github.com/DFHack/dfhack/issues/1151#issuecomment-322328655"},"message":"You could potentially use some Lua trickery to profile Lua timers, but that wouldn't help if it's not a Lua issue. I can see if it's possible if you like.\n\nThe requirements for compiling DFHack are documented in Compile.rst.","files":null},{"type":3,"author":{"id":"6879b8f55db2bdc58a4a5acfa01cd947d04b59d2"},"timestamp":1502768207,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMyMjM2OTAzNw==","github-url":"https://github.com/DFHack/dfhack/issues/1151#issuecomment-322369037"},"message":"We unloaded all the plugins and we still seem to get a 20-30 second lag every... well we need to measure it, but too frequently.  FPS is around 17.  260 citizens, default embark size.\n\nI also installed the Community Visual Studio 2017 and tried to run a profile .... which isn't that useful without symbols, but all the time during the hang was in the dwarffortress.exe, not in any dlls -- which I assume dfhack mostly exists in?\n\nSo... yeah, I don't think its dfhack.\n\nI still wonder, though, if a command might be useful that dumps the cumulative cpu/wall clock time of each plugin.   Maybe I'll try getting this compiled on Linux, which seems a bit simpler, and see if I can get something working --- but don't let that stop anyone else from also giving it a go :)","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1502770395,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDMyMjM3MzExNw==","github-url":"https://github.com/DFHack/dfhack/issues/1151#issuecomment-322373117"},"message":"Nearly all DFHack code should be running in SDL.dll (on Windows) or plugin DLLs. It's worth noting that DF calls out to that, so I don't know for sure how your profile would handle that.\n\nA profiling command could be useful, although there would need to be a way to enable/disable the data collection too.\n\nYou could also try disabling DFHack temporarily (by renaming SDL.dll to SDL-something.dll and SDLreal.dll to SDL.dll) if you really want to rule out DFHack.","files":null},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1503413389,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDEyMTYwODE4NDU="},"added":["idea"],"removed":[]}]}