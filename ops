{"version":1,"ops":[{"type":1,"author":{"id":"df7feee793b3a4f60453609739052ef8e882d092"},"timestamp":1479217936,"metadata":{"github-id":"MDU6SXNzdWUxODkzOTcxNTM=","github-url":"https://github.com/DFHack/dfhack/issues/1018","origin":"github"},"title":"getplants duplicates cutting/gathering orders if run multiple times","message":"The plugin designates the specified plants for gathering every time the command is executed. However, the designations are converted into jobs and it appears the designations are then reset, so when the command is executed again a while later it will designate all the plants for gathering again, resulting in new jobs targeting the same tiles.\nTo avoid this, getplants would have to iterate over the df.global.world.job_list to find duplicates and refrain from designating those tiles again.\n\nI found this when using a lua script based on getplants' logic to spare one of each kind of booze supporting fruit tree on my embark, running the script whenever I thought a bit too many new trees had popped up (and with a wood cutter doing other things mostly), and then saw my wood cutter cut a tree, walk away, return with a tree cutting order to the empty tile, walk away...\nI've verified that \"getplants CASHEW\" repeated a few times with DF running in between resulted in multiple tree cutting orders for the same set of 3 tiles (the number of cashews I happened to have at the time). While I only tested with trees, I assume the logic is the same with shrubs.","files":null}]}