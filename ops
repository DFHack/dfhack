{"version":1,"ops":[{"type":1,"author":{"id":"ac418b413e989a39aea293ae71f30420c724374f"},"timestamp":1416788930,"metadata":{"github-id":"MDU6SXNzdWU0OTg0NjY5MA==","github-url":"https://github.com/DFHack/dfhack/issues/404","origin":"github"},"title":"Missing static variable definition crashes DFHack compiled in debug mode","message":"Running DFHack produces this error:\n\n\u003e ./libs/Dwarf_Fortress: symbol lookup error: ./hack/libdfhack-debug.so: undefined symbol: _ZN9MapExtras9BiomeInfo10MAX_LAYERSE\n\nThat symbol is the variable MapExtras::BiomeInfo::MAX_LAYERS which is declared in MapCache.h but not defined elsewhere. Defining this variable in MapCache.cpp as follows fixes the error.\n\n\u003e diff --git a/library/modules/MapCache.cpp b/library/modules/MapCache.cpp\n\u003e index 5fc4878..404626e 100644\n\u003e --- a/library/modules/MapCache.cpp\n\u003e +++ b/library/modules/MapCache.cpp\n\u003e @@ -74,6 +74,8 @@ using df::global::world;\n\u003e \n\u003e extern bool GetLocalFeature(t_feature \u0026feature, df::coord2d rgn_pos, int32_t index);\n\u003e \n\u003e +const unsigned MapExtras::BiomeInfo::MAX_LAYERS;\n\u003e +\n\u003e const BiomeInfo MapCache::biome_stub = {\n\u003e     df::coord2d(),\n\u003e     -1, -1, -1, -1,","files":null}]}