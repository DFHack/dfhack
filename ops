{"version":1,"ops":[{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1591730731,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDM0MjY0OTQ4MjM="},"added":["question"],"removed":[]},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1591731130,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY0MTUyNTMyOA==","github-url":"https://github.com/DFHack/dfhack/issues/1588#issuecomment-641525328"},"message":"The gui.script module is a wrapper around [Lua coroutines](https://www.lua.org/manual/5.3/manual.html#2.6), which aren't really the same as threads. There isn't a way to tell if one is \"done\", as far as I know, so detecting when exportlegends has finished would be pretty hard.\n\nIf you're interested in waiting for a world to load, test/main.lua does something a bit hacky that works for the title screen - `script.delay()` delays a coroutine, which is a simple way to poll for a viewscreen change without repeated calls to `dfhack.timeout()`: https://github.com/DFHack/dfhack/blob/5d05cfc7ccadbad5dceab045f8e66bb064a2c43c/test/main.lua#L94-L112\n\nJust like exportlegends, test/main will return without waiting for coroutines to finish. It does support running another command when tests have finished, though. Maybe exportlegends could do this too.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1602389552,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDcwNjY0NzEwMw==","github-url":"https://github.com/DFHack/dfhack/issues/1588#issuecomment-706647103"},"message":"Assuming this was figured out in https://github.com/DFHack/scripts/pull/152","files":null},{"type":4,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1602389552,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50Mzg2MzMyMzg2Nw=="},"status":2}]}