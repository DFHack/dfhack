{"version":1,"ops":[{"type":1,"author":{"id":"f7b5a7930d0e1264ae1e4a774b03a7e78c2b7858"},"timestamp":1468551215,"metadata":{"github-id":"MDU6SXNzdWUxNjU3MDEwOTQ=","github-url":"https://github.com/DFHack/dfhack/issues/963","origin":"github"},"title":"RST parser for console version of script documentation","message":"When dumping script documentation to the console (#947), it would be nice to interpret the markup.\n\n[bay12 discussion here](http://www.bay12forums.com/smf/index.php?topic=121451.msg7091950#msg7091950)\n\n\u003e \u003e Would it be possible to make a print-like command for Lua (or just its own script) that accepts markdown syntax?  It doesn't need to be 100% faithful (maybe use colors for bold and italic), but something that could make sense out of the same markdown text used in the documentation on GitHub.\n\u003e \n\u003e Context:  documentation for scripts is now contained in the script files, between tokens that (in lua) denote a multiline comment or string (comment only in Ruby).  This text is marked up in \"restructured text\" format, which is similar to markdown but better for large documents, and used to generate the html docs.  It is also used as in-console help for some scripts - unifying the interactive help, documentation, and comments for maintainers.  An upgrade to the dfhack core command \"help\" is planned which will make the docs for all scripts available without adding -help flags on a per-script basis.\n\u003e \n\u003e Dirst - I think what you want is for help text in the console to have some actual formatting, rather than just dumping all the markup characters.  This is a logical extension of the open issue, and actually pretty easy to do.  (though IMO it's plenty readable anyway...)\n\u003e \n\u003e There are, I think, only a few main constructs to handle.  \n\u003e - **bold**, _italics_, and `monospace` can be handled by colors, and nesting is not supported.  \n\u003e - The title is always the first word, on it's own line, and underlined with its length in ===== on the next line -- another color would do.  \n\u003e - 'Definition lists' have the term (command) first between colons, then spaces to align and the explanation (possibly multiline) -- just color term and remove the colons.  \n\u003e - \"::\" indicates that the following (indented) block is monospaced; it should be replaced with \":\" if on the end of a line or removed if nothing precedes it.\n\u003e - leading and trailing empty lines should be stripped.\n\u003e - `cross-references` are surrounded by single backticks -- another color.\n\u003e \n\u003e It's not trivial, but nor would that be too difficult to implement in Lua.","files":null}]}