{"version":1,"ops":[{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1477278169,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI1NTYzODI4Mg==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-255638282"},"message":"``` cpp\nconst int TIXML_MAJOR_VERSION = 2;\nconst int TIXML_MINOR_VERSION = 5;\nconst int TIXML_PATCH_VERSION = 3;\n```\n\nThis appears to be https://sourceforge.net/projects/tinyxml/, which is the original TinyXML (I think), _not_ TinyXML2.\n\nI don't imagine we depend heavily on a specific version of TinyXML, so upgrading shouldn't be too bad if that would help.","files":null},{"type":5,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1477278178,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDgzMzI4ODMzNQ=="},"added":["crash/hang"],"removed":[]},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1477278262,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI1NTYzODQzMw==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-255638433"},"message":"I wouldn't expect this to be the case, but is it possible that DFHack is still using its own TinyXML headers? I don't know why that wouldn't show up before 0.43.05, though, unless your system TinyXML isn't the same architecture as DFHack and CMake is switching things up on you.","files":null},{"type":3,"author":{"id":"3777bd9464a985e5d5f5348b51d9318b5e1c4118"},"timestamp":1477278983,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI1NTYzOTU1MQ==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-255639551"},"message":"Hm, I suppose it's possible that the wrong headers are being picked up, but yeah, I'm not sure why that wouldn't have been an issue before this. I did double-check to make sure the 64-bit tinyxml is being detected properly by cmake: `TinyXML_LIBRARY:FILEPATH=/usr/lib64/libtinyxml.so` is definitely getting set.\n\n(I should probably have mentioned this was with 64-bit DF + DH in the initial report, my bad).\n\nThe last version of the original tinyxml looks to have been 2.6.2 back in 2011; that's what's packaged in Fedora. Given that tinyxml2 is now a thing I'd guess this is likely to be the last release for the foreseeable future. In which case it might make sense to upgrade in dfhack anyway?\n\nI can attempt building the dfhack tree with (bundled) tinyxml 2.6.2 sources and see if that changes anything.","files":null},{"type":3,"author":{"id":"3777bd9464a985e5d5f5348b51d9318b5e1c4118"},"timestamp":1477279864,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI1NTY0MDkwNg==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-255640906"},"message":"Hm... building dfhack against a bundled copy of tinyxml 2.6.2 seems to work just fine, but building with -DEXTERNAL_TINYXML still causes a crash (on 64-bit) even when building by hand and not using RPM.\n\nI also tested running `rm depends/tinyxml/*.cpp depends/tinyxml/*.h` before the build to ensure I wasn't accidentally linking against the bundled tinyxml and it didn't fix the issue either.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1478047038,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI1Nzc0MDYyNA==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-257740624"},"message":"Which compiler are you using?","files":null},{"type":3,"author":{"id":"3777bd9464a985e5d5f5348b51d9318b5e1c4118"},"timestamp":1478496102,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI1ODc0OTY5MQ==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-258749691"},"message":"gcc 6.2.1, which I realize is much newer than the recommended compiler (but that's the current version of gcc on Fedora-- I'm also using it to build dwarffortress's libgraphics.so, and that appears to be working alright).\n\nI can test an older gcc and see if that works any better.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1478496629,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI1ODc1MDU4Nw==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-258750587"},"message":"I mainly wanted to make sure it wasn't clang or something.\nOne possibility is the string ABI incompatibility. Maybe try compiling with `-D_GLIBCXX_USE_CXX11_ABI=0`? I would expect any issues related to that to result in linker errors, though.","files":null},{"type":3,"author":{"id":"57e3a4d5551fef965a0f00fa22aabe3f6dbade44"},"timestamp":1479946015,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI2MjY1OTg2Mw==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-262659863"},"message":"I can confirm that this this bug is fixed by using `-D_GLIBCXX_USE_CXX11_ABI=0`.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1479946541,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI2MjY2MDkwNw==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-262660907"},"message":"Thanks! That does appear to be in https://github.com/svenstaro/dwarf_fortress_unfuck/blob/d6a4ee67e7b41bec1caa87548640643db35a6080/CMakeLists.txt#L6, so that could explain why libgraphics was working.","files":null},{"type":3,"author":{"id":"3777bd9464a985e5d5f5348b51d9318b5e1c4118"},"timestamp":1480703944,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI2NDUyODc3Nw==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-264528777"},"message":"\u003e I can confirm that this this bug is fixed by using -D_GLIBCXX_USE_CXX11_ABI=0.\n\nIt seems like this is already set by default when building with gcc 5.0 or above in dfhack? [See here](https://github.com/DFHack/dfhack/blob/master/CMakeLists.txt#L24).\n\nIs there somewhere else I need to set this flag?\n\n@abbradar: what version of gcc did you use to build dfhack with -DEXTERNAL_TINYXML and have things work?","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1480704168,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI2NDUyOTY4Ng==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-264529686"},"message":"I'm talking about compiling tinyxml with that flag.","files":null},{"type":3,"author":{"id":"3777bd9464a985e5d5f5348b51d9318b5e1c4118"},"timestamp":1480704551,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI2NDUzMTMzMQ==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-264531331"},"message":"Oh! Yeah, that makes sense. I can now also confirm that that works.\n\nGood to know, although that's not really an option for Fedora packaging. Seems like until Toady updates to gcc \u003e 5.0 (assuming this ever happens) I'll just keep the bundled copy of tinyxml around.\n\nWhat I will do is send in a PR to update the bundled sources to the latest (final) tinyxml release, as I mentioned above.","files":null},{"type":3,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1481301629,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDI2NjA1OTk3OA==","github-url":"https://github.com/DFHack/dfhack/issues/1009#issuecomment-266059978"},"message":"I think DFHack is doing as much as it can to detect GCC 5+ itself, so I'm going to close this. Thanks for #1033, though!","files":null},{"type":4,"author":{"id":"e77d0a5f059ed8eaaa1afef6624480d02a2f025a"},"timestamp":1481301629,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50ODg4NTkyMzMx"},"status":2}]}