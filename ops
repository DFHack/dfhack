{"version":1,"ops":[{"type":1,"author":{"id":"d4ba99f16422e9377de56dab81d2b84415f00388"},"timestamp":1587767631,"metadata":{"github-id":"MDU6SXNzdWU2MDY2MTkzOTk=","github-url":"https://github.com/DFHack/dfhack/issues/1552","origin":"github"},"title":"Exportlegends remove empty claims for Entities","message":"There should be a check on \u003cclaims\u003e if it is (going to be) empty in the exportlegends.lau file.\n\nIf the tag is empty it should be removed.\n\nExample of current output:\n```\n\u003centity\u003e\n        \u003cid\u003e1\u003c/id\u003e\n        \u003crace\u003eant_man\u003c/race\u003e\n        \u003ctype\u003ecivilization\u003c/type\u003e\n        \u003cchild\u003e1\u003c/child\u003e\n        \u003cclaims\u003e                \u003c/claims\u003e\n\u003c/entity\u003e\n```\nDesired output:\n```\n\u003centity\u003e\n        \u003cid\u003e1\u003c/id\u003e\n        \u003crace\u003eant_man\u003c/race\u003e\n        \u003ctype\u003ecivilization\u003c/type\u003e\n        \u003cchild\u003e1\u003c/child\u003e\n\u003c/entity\u003e\n```\n( The unwanted extra spacing inside the tag is already addressed in: https://github.com/DFHack/scripts/pull/148 )\n\nSo there should be an if-test before this line.\nhttps://github.com/DFHack/scripts/blob/068ae13427c7bad0c084c21a1ac83eec91395efa/exportlegends.lua#L420\n```\n        if ...\u003ctest here\u003e... then\n            file:write(\"\\t\\t\u003cclaims\u003e\")\n            for xK, xVal in ipairs(entityV.claims.border.x) do\n                file:write(xVal..\",\"..entityV.claims.border.y[xK]..\"|\")\n            end\n            file:write(\"\u003c/claims\u003e\\n\")\n        end\n```","files":null}]}