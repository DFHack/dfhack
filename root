{"version":1,"ops":[{"type":1,"author":{"id":"09d05f81cc874e2f1a28b63036d18ae3fd2a6fe4"},"timestamp":1548738940,"metadata":{"github-id":"MDU6SXNzdWU0MDQxMjU5ODU=","github-url":"https://github.com/DFHack/dfhack/issues/1430","origin":"github"},"title":"Adventure mode \"commands\" full of null pointers","message":"Hello! This is my first time messing with writing dfhack scripts; please forgive any obvious mistakes I'm making.\n\nI'm trying to modify the \"get\" menu in adventure mode to show the value and weight of items next to their names. I have a lua script that I'm calling, and it accesses `df.global.ui_advmode.commands`. I can see the normal options for igniting plants or making campfires, but any options for picking up items are just nil. The order and number of nils correspond to the menu I see in-game, though; for example, when standing somewhere where there's nothing to pick up, I don't see any nils.\n\nHere's my code:\n```lua\nfunction getUpdate()\n    print(\"Length of commands is: \"..#df.global.ui_advmode.commands)\n    for i, foo in ipairs(df.global.ui_advmode.commands) do\n    \tprint(i, foo)\n    end\nend\n\ngetUpdate()\n```\n\nAnd here's some example output, standing over a large pile of items:\n```\nLength of commands is: 28\n0\tnil\n1\tnil\n2\tnil\n3\tnil\n4\tnil\n5\tnil\n6\tnil\n7\tnil\n8\tnil\n9\tnil\n10\tnil\n11\tnil\n12\t\u003cadventure_environment_pickup_make_campfirest: 0x7fffab809e90\u003e\n13\t\u003cadventure_environment_pickup_make_campfirest: 0x7fffe02680a0\u003e\n14\t\u003cadventure_environment_pickup_make_campfirest: 0x7fffe0a95390\u003e\n15\t\u003cadventure_environment_pickup_make_campfirest: 0x7fffaae557d0\u003e\n16\t\u003cadventure_environment_pickup_make_campfirest: 0x7fffb24d1dc0\u003e\n17\t\u003cadventure_environment_pickup_make_campfirest: 0x7fffaba76720\u003e\n18\t\u003cadventure_environment_pickup_make_campfirest: 0x7fffb399d6b0\u003e\n19\t\u003cadventure_environment_pickup_make_campfirest: 0x7fffabc76210\u003e\n20\t\u003cadventure_environment_pickup_ignite_vegst: 0x7fffaae556f0\u003e\n21\t\u003cadventure_environment_pickup_ignite_vegst: 0x7fffb3932f70\u003e\n22\t\u003cadventure_environment_pickup_ignite_vegst: 0x7fffb3a86120\u003e\n23\t\u003cadventure_environment_pickup_ignite_vegst: 0x7fffe0b554f0\u003e\n24\t\u003cadventure_environment_pickup_ignite_vegst: 0x7fffe0b54d80\u003e\n25\t\u003cadventure_environment_pickup_ignite_vegst: 0x7fffe0a94ed0\u003e\n26\t\u003cadventure_environment_pickup_ignite_vegst: 0x7fffabecb440\u003e\n27\t\u003cadventure_environment_pickup_ignite_vegst: 0x7fffe0a98330\u003e\n```\n\nAm I doing something wrong? Or is this the expected behavior? If it is, is there a different way I should be trying to accomplish my goal? Thanks!","files":null}]}