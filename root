{"version":1,"ops":[{"type":1,"author":{"id":"78ba4f5d813d93eaa6e692a2e66d44d9e98552ad"},"timestamp":1423601678,"metadata":{"github-id":"MDU6SXNzdWU1NzIzNTEyNA==","github-url":"https://github.com/DFHack/dfhack/issues/546","origin":"github"},"title":"Future of the armory binpatches","message":"Comparing two executables against one another, I'm slowly snooping out where Angavrilov's old binary patches go in the current Windows version.\n\nhttp://www.bay12games.com/dwarves/mantisbt/view.php?id=1445#c23694\n\nweaponrack-unassign moved down by 0xFF3C0, so the chunks of code in 0x4C05C4 and 0x4C06A1 are now found in 0x5BF984 and 0x5BFA61 respectively. I've manually altered my own .exe and can see it works.\n\nThe parts in armorstand-capacity that involve altering old stuff (and not adding extra detours into empty space) look like they have jumped down by 0x24220. The old addresses 0x34D91, 0x34E53 and 0x34EF3 and their surroundings look an awful lot like v40.24's 0x58FB1, 0x59073 and 0x59113. There seem to be empty CC CC CC CC patches offset by 0x24220 like the rest, but I'm still a little uncertain how to make the relocated instructions point to the right places again.\n\nLethosor put forward the reasonable thought that these should be deprecated in favor of doing the thing with DFHack's own tools, but that's where I'm in over my head. I'm okay at detective work like this, but all I know about C is what Sesame Street taught me.","files":null}]}