{"version":1,"ops":[{"type":1,"author":{"id":"46202e13a8d330c3afa794834dc7e4b35ceeba95"},"timestamp":1498084676,"metadata":{"github-id":"MDU6SXNzdWUyMzc2ODQzMTY=","github-url":"https://github.com/DFHack/dfhack/issues/1117","origin":"github"},"title":"show-unit-syndromes.rb - error when printing FLASH_TILE syndrome","message":"[show-unit-syndromes.rb](https://github.com/DFHack/scripts/blob/master/show-unit-syndromes.rb#L732-L733) has this code:\n```\n  when \"FLASH_TILE\"\n    if !showdisplayeffects then return \"\", Output::DEFAULT end\n    name = \"Flash\"\n    color = ce.sym_color \u003e\u003e 8\n    tile = ce.sym_color - (color * 256)\n    desc = \"tile = #{tile}, colour=#{color}, time=#{ce.period}, period=#{ce.time}\"\n    color = Output::DEFAULT\n```\n\nwhich sadly stopped working properly after [this change](https://github.com/DFHack/df-structures/commit/86f0181ba172de03a73f88789675e6f8cf885a33#diff-5348c5d50fabd4fe1a69a6807a98e2f4L307):\n```patch\n...\n     \u003cclass-type type-name='creature_interaction_effect_flash_symbolst'\n￼                  inherits-from='creature_interaction_effect'\u003e\n-         \u003cint32_t name=\"sym_color\"/\u003e\n+         \u003cstatic-array type-name='uint8_t' name=\"sym_color\" count='4'/\u003e\n￼          \u003cint32_t name=\"period\"/\u003e\n￼          \u003cint32_t name=\"time\"/\u003e\n...\n```\n\nresulting in this output:\n```\nE: NoMethodError: undefined method `\u003e\u003e' for [165, 3, 0, 0]:DFHack::MemHack::StaticArray\n /opt/dfhack/hack/scripts/show-unit-syndromes.rb:732:in `get_effect'\n /opt/dfhack/hack/scripts/show-unit-syndromes.rb:908:in `block (2 levels) in \u003ctop (required)\u003e'\n /opt/dfhack/hack/ruby/ruby-autogen-defs.rb:420:in `block in each'\n /opt/dfhack/hack/ruby/ruby-autogen-defs.rb:420:in `each'\n /opt/dfhack/hack/ruby/ruby-autogen-defs.rb:420:in `each'\n /opt/dfhack/hack/scripts/show-unit-syndromes.rb:908:in `collect'\n /opt/dfhack/hack/scripts/show-unit-syndromes.rb:908:in `block in \u003ctop (required)\u003e'\n /opt/dfhack/hack/scripts/show-unit-syndromes.rb:1032:in `[]'\n```\n\nIt should be a trivial fix, but I don't really know ruby or the dfhack codebase. I assume that either `color = ce.sym_color[0]` or `color = ce.sym_color[3]`  would give the intended result though.","files":null}]}