{"version":1,"ops":[{"type":6,"author":{"id":"95fd2ef9331b0618ecb1b26f73c85869e45d7bcc"},"timestamp":1602434084,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlRWRpdDo0NDAxOTgzNzA="},"target":"e78236cd3c068b659213bd8444e51b32aa20e10568d489e8b00baead32349127","message":"I am running DwarfFortress on an Arch Linux system with theses package versions:\n\n- aur/dfhack-bin 0.47.04-4 (which reports as DFHack version 0.47.04-r2 (release) on x86_64)\n- community/dwarffortress 0.47.04-2\n\nI have created a world and saved some stockpile configurations which when trying to load them in a new fort cause DF to hang with\n\n````\nCommon lua context stack top left at 1 after suspend.\nConsole is shutting down properly.\n````\n\nbeing the last significant lines in `~/.dwarffortress/stderr.log`\n\nThese are the crashing and working stockpile files:\n\n- [crashing.zip](https://github.com/DFHack/dfhack/files/5361402/crashing.zip)\n- [working.zip](https://github.com/DFHack/dfhack/files/5361403/working.zip)\n\nAny ideas how to avoid this?","files":null},{"type":3,"author":{"id":"95fd2ef9331b0618ecb1b26f73c85869e45d7bcc"},"timestamp":1602433232,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDcwNjcyOTE3NQ==","github-url":"https://github.com/DFHack/dfhack/issues/1668#issuecomment-706729175"},"message":"Trying to load one of the crashing dfstock files directly from the dfhack console results in:\n\n````\nInvoking: loadstock \"stocksettings/Materials for Workshops.dfstock\"\nunserialization failed: protobuf exception: Resource deadlock avoided\nunserialization failed: protobuf exception: Resource deadlock avoided\nConsole is shutting down properly.\n````\n\nin the `stderr.log`","files":null},{"type":3,"author":{"id":"95fd2ef9331b0618ecb1b26f73c85869e45d7bcc"},"timestamp":1602433485,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDcwNjcyOTcyNQ==","github-url":"https://github.com/DFHack/dfhack/issues/1668#issuecomment-706729725"},"message":"`loadstock --debug \"stocksettings/Materials for Workshops.dfstock\"` gives in `stderr.log`:\n\n````\nInvoking: loadstock --debug \"stocksettings/Materials for Workshops.dfstock\"\nunserialization failed: protobuf exception: Resource deadlock avoided\nfood_idx_by_token: unserialization failed: protobuf exception: Resource deadlock avoided\nConsole is shutting down properly.\n````\n\nand on the console:\n\n````\n[DFHack]# loadstock --debug \"stocksettings/Materials for Workshops.dfstock\"\n\n==READ==\nbars_blocks: \n   material 0 is INORGANIC:IRON\n   material 1 is INORGANIC:GOLD\n   material 2 is INORGANIC:SILVER\n   material 3 is INORGANIC:COPPER\n   material 4 is INORGANIC:NICKEL\n   material 5 is INORGANIC:ZINC\n   material 6 is INORGANIC:BRONZE\n   material 7 is INORGANIC:BRASS\n   material 8 is INORGANIC:STEEL\n   material 9 is INORGANIC:PIG_IRON\n   material 10 is INORGANIC:PLATINUM\n   material 11 is INORGANIC:ELECTRUM\n   material 12 is INORGANIC:TIN\n   material 13 is INORGANIC:PEWTER_FINE\n   material 14 is INORGANIC:PEWTER_TRIFLE\n   material 15 is INORGANIC:PEWTER_LAY\n   material 16 is INORGANIC:LEAD\n   material 17 is INORGANIC:ALUMINUM\n   material 18 is INORGANIC:NICKEL_SILVER\n   material 19 is INORGANIC:BILLON\n   material 20 is INORGANIC:STERLING_SILVER\n   material 21 is INORGANIC:BLACK_BRONZE\n   material 22 is INORGANIC:ROSE_GOLD\n   material 23 is INORGANIC:BISMUTH\n   material 24 is INORGANIC:BISMUTH_BRONZE\n   material 25 is INORGANIC:ADAMANTINE\n   material 265 is INORGANIC:DIVINE_1\n   material 267 is INORGANIC:DIVINE_3\n   material 269 is INORGANIC:DIVINE_5\n   material 271 is INORGANIC:DIVINE_7\n   material 273 is INORGANIC:DIVINE_9\n   material 275 is INORGANIC:DIVINE_11\n   material 277 is INORGANIC:DIVINE_13\n   material 279 is INORGANIC:DIVINE_15\n   material 281 is INORGANIC:DIVINE_17\n   material 283 is INORGANIC:DIVINE_19\n   material 0 is INORGANIC:IRON\n   material 1 is INORGANIC:GOLD\n   material 2 is INORGANIC:SILVER\n   material 3 is INORGANIC:COPPER\n   material 4 is INORGANIC:NICKEL\n   material 5 is INORGANIC:ZINC\n   material 6 is INORGANIC:BRONZE\n   material 7 is INORGANIC:BRASS\n   material 8 is INORGANIC:STEEL\n   material 9 is INORGANIC:PIG_IRON\n   material 10 is INORGANIC:PLATINUM\n   material 11 is INORGANIC:ELECTRUM\n   material 12 is INORGANIC:TIN\n   material 13 is INORGANIC:PEWTER_FINE\n   material 14 is INORGANIC:PEWTER_TRIFLE\n   material 15 is INORGANIC:PEWTER_LAY\n   material 16 is INORGANIC:LEAD\n   material 17 is INORGANIC:ALUMINUM\n   material 18 is INORGANIC:NICKEL_SILVER\n   material 19 is INORGANIC:BILLON\n   material 20 is INORGANIC:STERLING_SILVER\n   material 21 is INORGANIC:BLACK_BRONZE\n   material 22 is INORGANIC:ROSE_GOLD\n   material 23 is INORGANIC:BISMUTH\n   material 24 is INORGANIC:BISMUTH_BRONZE\n   material 25 is INORGANIC:ADAMANTINE\n   material 26 is INORGANIC:PLASTER\n   material 27 is INORGANIC:CERAMIC_EARTHENWARE\n   material 28 is INORGANIC:CERAMIC_STONEWARE\n   material 29 is INORGANIC:CERAMIC_PORCELAIN\n   material 30 is INORGANIC:ASH_GLAZE\n   material 31 is INORGANIC:TIN_GLAZE\n   material 161 is INORGANIC:SANDSTONE\n   material 162 is INORGANIC:SILTSTONE\n   material 163 is INORGANIC:MUDSTONE\n   material 164 is INORGANIC:SHALE\n   material 165 is INORGANIC:CLAYSTONE\n   material 166 is INORGANIC:ROCK_SALT\n   material 167 is INORGANIC:LIMESTONE\n   material 168 is INORGANIC:CONGLOMERATE\n   material 169 is INORGANIC:DOLOMITE\n   material 170 is INORGANIC:CHERT\n   material 171 is INORGANIC:CHALK\n   material 172 is INORGANIC:GRANITE\n   material 173 is INORGANIC:DIORITE\n   material 174 is INORGANIC:GABBRO\n   material 175 is INORGANIC:RHYOLITE\n   material 176 is INORGANIC:BASALT\n   material 177 is INORGANIC:ANDESITE\n   material 178 is INORGANIC:DACITE\n   material 179 is INORGANIC:OBSIDIAN\n   material 180 is INORGANIC:QUARTZITE\n   material 181 is INORGANIC:SLATE\n   material 182 is INORGANIC:PHYLLITE\n   material 183 is INORGANIC:SCHIST\n   material 184 is INORGANIC:GNEISS\n   material 185 is INORGANIC:MARBLE\n   material 186 is INORGANIC:HEMATITE\n   material 187 is INORGANIC:LIMONITE\n   material 188 is INORGANIC:GARNIERITE\n   material 189 is INORGANIC:NATIVE_GOLD\n   material 190 is INORGANIC:NATIVE_SILVER\n   material 191 is INORGANIC:NATIVE_COPPER\n   material 192 is INORGANIC:MALACHITE\n   material 193 is INORGANIC:GALENA\n   material 194 is INORGANIC:SPHALERITE\n   material 195 is INORGANIC:CASSITERITE\n   material 196 is INORGANIC:COAL_BITUMINOUS\n   material 197 is INORGANIC:LIGNITE\n   material 198 is INORGANIC:NATIVE_PLATINUM\n   material 199 is INORGANIC:CINNABAR\n   material 200 is INORGANIC:COBALTITE\n   material 201 is INORGANIC:TETRAHEDRITE\n   material 202 is INORGANIC:HORN_SILVER\n   material 203 is INORGANIC:GYPSUM\n   material 204 is INORGANIC:TALC\n   material 205 is INORGANIC:JET\n   material 206 is INORGANIC:PUDDINGSTONE\n   material 207 is INORGANIC:PETRIFIED_WOOD\n   material 208 is INORGANIC:GRAPHITE\n   material 209 is INORGANIC:BRIMSTONE\n   material 210 is INORGANIC:KIMBERLITE\n   material 211 is INORGANIC:BISMUTHINITE\n   material 212 is INORGANIC:REALGAR\n   material 213 is INORGANIC:ORPIMENT\n   material 214 is INORGANIC:STIBNITE\n   material 215 is INORGANIC:MARCASITE\n   material 216 is INORGANIC:SYLVITE\n   material 217 is INORGANIC:CRYOLITE\n   material 218 is INORGANIC:PERICLASE\n   material 219 is INORGANIC:ILMENITE\n   material 220 is INORGANIC:RUTILE\n   material 221 is INORGANIC:MAGNETITE\n   material 222 is INORGANIC:CHROMITE\n   material 223 is INORGANIC:PYROLUSITE\n   material 224 is INORGANIC:PITCHBLENDE\n   material 225 is INORGANIC:BAUXITE\n   material 226 is INORGANIC:NATIVE_ALUMINUM\n   material 227 is INORGANIC:BORAX\n   material 228 is INORGANIC:OLIVINE\n   material 229 is INORGANIC:HORNBLENDE\n   material 230 is INORGANIC:KAOLINITE\n   material 231 is INORGANIC:SERPENTINE\n   material 232 is INORGANIC:ORTHOCLASE\n   material 233 is INORGANIC:MICROCLINE\n   material 234 is INORGANIC:MICA\n   material 235 is INORGANIC:CALCITE\n   material 236 is INORGANIC:SALTPETER\n   material 237 is INORGANIC:ALABASTER\n   material 238 is INORGANIC:SELENITE\n   material 239 is INORGANIC:SATINSPAR\n   material 240 is INORGANIC:ANHYDRITE\n   material 241 is INORGANIC:ALUNITE\n   material 242 is INORGANIC:RAW_ADAMANTINE\n   material 243 is INORGANIC:SLADE\n   material 265 is INORGANIC:DIVINE_1\n   material 267 is INORGANIC:DIVINE_3\n   material 269 is INORGANIC:DIVINE_5\n   material 271 is INORGANIC:DIVINE_7\n   material 273 is INORGANIC:DIVINE_9\n   material 275 is INORGANIC:DIVINE_11\n   material 277 is INORGANIC:DIVINE_13\n   material 279 is INORGANIC:DIVINE_15\n   material 281 is INORGANIC:DIVINE_17\n   material 283 is INORGANIC:DIVINE_19\n  other_mats 0 is COAL\n  other_mats 1 is POTASH\n  other_mats 2 is ASH\n  other_mats 3 is PEARLASH\n  other_mats 4 is SOAP\n  other_mats 0 is GREEN_GLASS\n  other_mats 1 is CLEAR_GLASS\n  other_mats 2 is CRYSTAL_GLASS\n  other_mats 3 is WOOD\ngems: \n   material 34 is INORGANIC:ONYX\n   material 35 is INORGANIC:MORION\n   material 36 is INORGANIC:SCHORL\n   material 37 is INORGANIC:LACE AGATE\n   material 38 is INORGANIC:BLUE JADE\n   material 39 is INORGANIC:LAPIS LAZULI\n   material 40 is INORGANIC:PRASE\n   material 41 is INORGANIC:PRASE OPAL\n   material 42 is INORGANIC:BLOODSTONE\n   material 43 is INORGANIC:MOSS AGATE\n   material 44 is INORGANIC:MOSS OPAL\n   material 45 is INORGANIC:VARISCITE\n   material 46 is INORGANIC:CHRYSOPRASE\n   material 47 is INORGANIC:CHRYSOCOLLA\n   material 48 is INORGANIC:SARD\n   material 49 is INORGANIC:CARNELIAN\n   material 50 is INORGANIC:BANDED AGATE\n   material 51 is INORGANIC:SARDONYX\n   material 52 is INORGANIC:CHERRY OPAL\n   material 53 is INORGANIC:LAVENDER JADE\n   material 54 is INORGANIC:PINK JADE\n   material 55 is INORGANIC:TUBE AGATE\n   material 56 is INORGANIC:FIRE AGATE\n   material 57 is INORGANIC:PLUME AGATE\n   material 58 is INORGANIC:BROWN JASPER\n   material 59 is INORGANIC:PICTURE JASPER\n   material 60 is INORGANIC:SMOKY QUARTZ\n   material 61 is INORGANIC:WAX OPAL\n   material 62 is INORGANIC:WOOD OPAL\n   material 63 is INORGANIC:AMBER OPAL\n   material 64 is INORGANIC:GOLD OPAL\n   material 65 is INORGANIC:CITRINE\n   material 66 is INORGANIC:YELLOW JASPER\n   material 67 is INORGANIC:TIGEREYE\n   material 68 is INORGANIC:TIGER IRON\n   material 69 is INORGANIC:SUNSTONE\n   material 70 is INORGANIC:RESIN OPAL\n   material 71 is INORGANIC:PYRITE\n   material 72 is INORGANIC:CLEAR TOURMALINE\n   material 73 is INORGANIC:GRAY CHALCEDONY\n   material 74 is INORGANIC:DENDRITIC AGATE\n   material 75 is INORGANIC:SHELL OPAL\n   material 76 is INORGANIC:BONE OPAL\n   material 77 is INORGANIC:WHITE CHALCEDONY\n   material 78 is INORGANIC:FORTIFICATION AGATE\n   material 79 is INORGANIC:MILK QUARTZ\n   material 80 is INORGANIC:MOONSTONE\n   material 81 is INORGANIC:WHITE JADE\n   material 82 is INORGANIC:JASPER OPAL\n   material 83 is INORGANIC:PINEAPPLE OPAL\n   material 84 is INORGANIC:ONYX OPAL\n   material 85 is INORGANIC:MILK OPAL\n   material 86 is INORGANIC:PIPE OPAL\n   material 87 is INORGANIC:AVENTURINE\n   material 88 is INORGANIC:TURQUOISE\n   material 89 is INORGANIC:QUARTZ_ROSE\n   material 90 is INORGANIC:CRYSTAL_ROCK\n   material 91 is INORGANIC:BLACK ZIRCON\n   material 92 is INORGANIC:BLACK PYROPE\n   material 93 is INORGANIC:MELANITE\n   material 94 is INORGANIC:INDIGO TOURMALINE\n   material 95 is INORGANIC:BLUE GARNET\n   material 96 is INORGANIC:TSAVORITE\n   material 97 is INORGANIC:GREEN TOURMALINE\n   material 98 is INORGANIC:DEMANTOID\n   material 99 is INORGANIC:GREEN ZIRCON\n   material 100 is INORGANIC:GREEN JADE\n   material 101 is INORGANIC:HELIODOR\n   material 102 is INORGANIC:PERIDOT\n   material 103 is INORGANIC:RED ZIRCON\n   material 104 is INORGANIC:RED TOURMALINE\n   material 105 is INORGANIC:RED PYROPE\n   material 106 is INORGANIC:ALMANDINE\n   material 107 is INORGANIC:RED GROSSULAR\n   material 108 is INORGANIC:PINK TOURMALINE\n   material 109 is INORGANIC:RED BERYL\n   material 110 is INORGANIC:FIRE OPAL\n   material 111 is INORGANIC:RHODOLITE\n   material 112 is INORGANIC:SPINEL_PURPLE\n   material 113 is INORGANIC:ALEXANDRITE\n   material 114 is INORGANIC:TANZANITE\n   material 115 is INORGANIC:MORGANITE\n   material 116 is INORGANIC:VIOLET SPESSARTINE\n   material 117 is INORGANIC:PINK GARNET\n   material 118 is INORGANIC:KUNZITE\n   material 119 is INORGANIC:CINNAMON GROSSULAR\n   material 120 is INORGANIC:HONEY YELLOW BERYL\n   material 121 is INORGANIC:JELLY OPAL\n   material 122 is INORGANIC:BROWN ZIRCON\n   material 123 is INORGANIC:YELLOW ZIRCON\n   material 124 is INORGANIC:GOLDEN BERYL\n   material 125 is INORGANIC:YELLOW SPESSARTINE\n   material 126 is INORGANIC:TOPAZ\n   material 127 is INORGANIC:TOPAZOLITE\n   material 128 is INORGANIC:YELLOW GROSSULAR\n   material 129 is INORGANIC:RUBICELLE\n   material 130 is INORGANIC:CLEAR GARNET\n   material 131 is INORGANIC:GOSHENITE\n   material 132 is INORGANIC:CAT'S EYE\n   material 133 is INORGANIC:CLEAR ZIRCON\n   material 134 is INORGANIC:AMETHYST\n   material 135 is INORGANIC:AQUAMARINE\n   material 136 is INORGANIC:SPINEL_RED\n   material 137 is INORGANIC:CHRYSOBERYL\n   material 138 is INORGANIC:OPAL_PFIRE\n   material 139 is INORGANIC:OPAL_REDFLASH\n   material 140 is INORGANIC:OPAL_BLACK\n   material 141 is INORGANIC:OPAL_WHITE\n   material 142 is INORGANIC:OPAL_CRYSTAL\n   material 143 is INORGANIC:OPAL_CLARO\n   material 144 is INORGANIC:OPAL_LEVIN\n   material 145 is INORGANIC:OPAL_HARLEQUIN\n   material 146 is INORGANIC:OPAL_PINFIRE\n   material 147 is INORGANIC:OPAL_BANDFIRE\n   material 148 is INORGANIC:DIAMOND_LY\n   material 149 is INORGANIC:DIAMOND_FY\n   material 150 is INORGANIC:EMERALD\n   material 151 is INORGANIC:RUBY\n   material 152 is INORGANIC:SAPPHIRE\n   material 153 is INORGANIC:DIAMOND_CLEAR\n   material 154 is INORGANIC:DIAMOND_RED\n   material 155 is INORGANIC:DIAMOND_GREEN\n   material 156 is INORGANIC:DIAMOND_BLUE\n   material 157 is INORGANIC:DIAMOND_YELLOW\n   material 158 is INORGANIC:DIAMOND_BLACK\n   material 159 is INORGANIC:SAPPHIRE_STAR\n   material 160 is INORGANIC:RUBY_STAR\n   rough_other mats 3 is GLASS_GREEN\n   rough_other mats 4 is GLASS_CLEAR\n   rough_other mats 5 is GLASS_CRYSTAL\nleather: \n````\n\nAfter that it hangs.","files":null},{"type":3,"author":{"id":"95fd2ef9331b0618ecb1b26f73c85869e45d7bcc"},"timestamp":1602434465,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDcwNjczMjM2Nw==","github-url":"https://github.com/DFHack/dfhack/issues/1668#issuecomment-706732367"},"message":"Reminder to self: check latest release before reporting bugs.\n\nWorks with -r3","files":null},{"type":4,"author":{"id":"95fd2ef9331b0618ecb1b26f73c85869e45d7bcc"},"timestamp":1602434465,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50Mzg2Mzg2MTA2MQ=="},"status":2}]}