{"version":1,"ops":[{"type":1,"author":{"id":"c8bdff833a0d45e9a1c07751adfd0917db2f83d1"},"timestamp":1603043783,"metadata":{"github-id":"MDU6SXNzdWU3MjQwNjE4Mzk=","github-url":"https://github.com/DFHack/dfhack/issues/1677","origin":"github"},"title":"Easily reproducible crash, linux only","message":"## Easily (I hope) reproducible crash, linux only\nHi. I have save with a long-running fortress. The save consistently crashing always some about 10-15 seconds after unpausing loaded game.\nThe environment where it happens:\n -`DFHack 0.47.04-r3` (I can confirm the same happen on  `0.47.04-r2`)\n - `Dwarf Fortress v0.47.04`\n - Linux arch (fresh kernel: `Linux 5.9.1-arch1-1`)\n - I checked at fresh installation (second laptop, where DwarfFortress and other utilities have not been installed before)\n\nMy findings:\n- the crash does not happen without `DFHack` (when I run the game directly). It looks like DFHack issue\n- I moved the save files to a second, very different laptop, but with Linux arch too. It's crashing in the same way. \n- I tested it on Windows too. Surprisingly, the crash **do not** happens on Windows build.\n- I tried a lot of ways how to prevent it \"in-game\":\n  - I found that if I disband ALL squads, the crash will not happen. Only this helped\n  - if even one squad left, the crash will happen\n  - I tried to remove all squad members. Even if I left empty squads, without squad members, the crash would happen\n  - I tried to remove all alerts and schedules, it did not help\n  - I tried to remove all specific weapons chosen for squads members (I have few artifacts weapons). It did not help.\n- the same problem happened to me in the same fort an in-game year or two before. Then, I just disbanded all squads and created them from fresh. It helped, and I forgot about it.\n\nThere is a backtrace from the crash (I used `dfhack -g` mode):\n```\n#0  0x0000000000e414fe in  ()\n#1  0x0000000000e43360 in  ()\n#2  0x0000000000e530a5 in  ()\n#3  0x00000000007a1cca in  ()\n#4  0x00007ffff704ce37 in interfacest::loop() (this=0x2327660 \u003cgview\u003e) at /build/dwarffortress/src/dwarf_fortress_unfuck/g_src/interface.cpp:863\n#5  0x0000000000a486ee in mainloop() ()\n#6  0x00007ffff7012424 in enablerst::async_loop() (this=0x19bda80 \u003cenabler\u003e) at /build/dwarffortress/src/dwarf_fortress_unfuck/g_src/enabler.cpp:337\n#7  0x00007ffff701384c in call_loop(void*) (dummy=0x0) at /build/dwarffortress/src/dwarf_fortress_unfuck/g_src/enabler.cpp:708\n#8  0x00007ffff74324cb in  () at /usr/lib/libSDL-1.2.so.0\n#9  0x00007ffff747516a in  () at /usr/lib/libSDL-1.2.so.0\n#10 0x00007ffff69b33e9 in start_thread () at /usr/lib/libpthread.so.0\n#11 0x00007ffff6b46293 in clone () at /usr/lib/libc.so.6\n```\nLet me know if I can provide some more information. I have a technical background.\nI am cool with giving a link to the save here, or in a private message, if someone could look at it.","files":null}]}