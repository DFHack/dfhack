{"version":1,"ops":[{"type":1,"author":{"id":"fefd87bd170e69ba989c5932b26d53a6f30e8666"},"timestamp":1400365687,"metadata":{"github-id":"MDU6SXNzdWUzMzc0MTAwNw==","github-url":"https://github.com/DFHack/dfhack/issues/245","origin":"github"},"title":"Names containing \"the [words]\" are translated to English incorrectly","message":"In [plugins/ruby/ruby.rb:212-216](https://github.com/DFHack/dfhack/blob/0.34.11-r3/plugins/ruby/ruby.rb#L212-L216), the code to translate names to English in a different way than Dwarf Fortress does.\n\n![Fig. 1](http://i.imgur.com/r9mkxhc.png)\n\n[from dwarffortresswiki.org](http://dwarffortresswiki.org/index.php/User:Andux/Format_research), edited for zero-based indexing:\n\n```\n\u003cName\u003e[ \u003cWord[0]\u003e\u003cWord[1]\u003e][ the [\u003cWord[2]\u003e ][\u003cWord[3]\u003e ][\u003cWord[4]\u003e-]\u003cWord[5]\u003e][ of \u003cWord[6]\u003e]\n```\n\ndfhack currently does not insert the space after 2 or 3 or the hyphen after 4.\n\nhere is the corrected code:\n\n```\n            if name.words[5] \u003e= 0\n                out \u003c\u003c 'the'\n                out.last.capitalize! if out.length == 1\n                out \u003c\u003c wl.words[name.words[2]].forms[name.parts_of_speech[2]] if name.words[2] \u003e= 0\n                out \u003c\u003c wl.words[name.words[3]].forms[name.parts_of_speech[3]] if name.words[3] \u003e= 0\n                if name.words[4] \u003e= 0\n                    out \u003c\u003c wl.words[name.words[4]].forms[name.parts_of_speech[4]]\n                    out \u003c\u003c '-'\n                else\n                    out \u003c\u003c ''\n                end\n                out.last \u003c\u003c wl.words[name.words[5]].forms[name.parts_of_speech[5]]\n            end\n```","files":null}]}